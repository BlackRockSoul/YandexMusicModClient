(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8601],{78601:function(e,t,a){"use strict";a.d(t,{Xb:function(){return i.AlbumPage},Lf:function(){return k}});var i=a(93289);a(74488);var l=a(42288),s=a(10542),n=a(59131),o=a(82857),r=a(93490),d=a(10064),u=a(75191),m=a(38360),c=a(44367),b=a(13196);let v=(e,t)=>e.map(e=>"".concat(e,":").concat(t));var g=a(75545);let A=e=>({type:m.lf.TEXT,data:e||null}),h=(e,t,a,i,l)=>({type:(null==a?void 0:a.type)||n.Vc.TRACK,id:e,data:a||null,loadingState:t,position:i,isBest:l}),p=e=>"".concat(e,"-text"),E=e=>String(e),x=(e,t,a,i)=>{e.forEach(e=>{var l,s,n,o,r;if(null===(l=e.albums)||void 0===l?void 0:l[0]){let l=a.get(E(e.id));void 0!==l&&(t[l]=h(e.id,c.Gu.RESOLVE,(0,g.Vt)(e),null===(n=e.albums[0])||void 0===n?void 0:null===(s=n.trackPosition)||void 0===s?void 0:s.index,null==i?void 0:i.includes(Number(e.id))));let d=a.get(p(e.id));void 0!==d&&(t[d]=A(null===(r=e.albums[0])||void 0===r?void 0:null===(o=r.trackPosition)||void 0===o?void 0:o.volume))}})},C=(e,t,a,i)=>{let l=0;e.volumes.forEach(s=>{e.volumes.length>1&&s[0]&&(t.push(A()),a.set(p(s[0].id),t.length-1)),s.forEach(e=>{t.push(h(e.id,c.Gu.IDLE)),a.set(E(e.id),t.length-1),i.set(E(e.id),l),l++})})},N=e=>(0,l.pj)({id:e.id,type:e.type,title:e.title,albums:e.albums.map(r.ym)}),S=(e,t,a,i)=>{e.forEach(e=>{let l=a.get(String(e));void 0!==l&&(t[l]=h(e,i))})},I=l.V5.model("AlbumDonations",{loadingState:l.V5.enumeration(Object.values(c.Gu)),items:l.V5.maybeNull(l.V5.array(d.Ew))}),f=l.V5.model("LabelItem",{id:l.V5.number,name:l.V5.string}),G=l.V5.model("RelatedAlbumsPage",{loadingState:l.V5.enumeration(Object.values(c.Gu)),items:l.V5.array(r.ug)}),L=l.V5.model("RelatedContent",{loadingState:l.V5.enumeration(Object.values(c.Gu)),items:l.V5.maybeNull(l.V5.array(o.fd))}),k=l.V5.compose(l.V5.model("AlbumPage",{id:l.V5.maybeNull(l.V5.number),meta:l.V5.maybeNull(r.ug),items:l.V5.array(o.JP),indexItems:l.V5.map(l.V5.number),trackIndexInContext:l.V5.map(l.V5.number),loadingState:l.V5.enumeration(Object.values(c.Gu)),errorStatusCode:l.V5.maybeNull(l.V5.number),deprecationTargetAlbumId:l.V5.maybeNull(l.V5.number),latestGenreAlbums:G,otherArtistAlbums:G,otherAlbumVersions:l.V5.array(r.ug),labels:l.V5.maybeNull(l.V5.array(f)),description:l.V5.maybe(l.V5.string),donations:I,relatedContent:L}),b.ie).views(e=>({get isNonMusicType(){var t;if(null===(t=e.meta)||void 0===t?void 0:t.type)return[n.VZ.PODCAST,n.VZ.AUDIOBOOK].includes(e.meta.type);return!1},get isOtherArtistAlbumsAvailable(){var a,i,l,o;return!!(!this.isNonMusicType&&(null===(i=e.meta)||void 0===i?void 0:null===(a=i.artists)||void 0===a?void 0:a.length)===1&&!(null===(o=e.meta)||void 0===o?void 0:null===(l=o.artists[0])||void 0===l?void 0:l.various))},get isLatestGenreAlbumsAvailable(){var r;return!!(!this.isNonMusicType&&(null===(r=e.meta)||void 0===r?void 0:r.genre))},get isNotFound(){return e.loadingState===c.Gu.REJECT&&e.errorStatusCode===s.CN.NOT_FOUND},get isRejected(){return e.loadingState===c.Gu.REJECT},get hasOtherAlbumVersions(){return!!(e.loadingState===c.Gu.IDLE||e.loadingState===c.Gu.PENDING||e.otherAlbumVersions&&e.otherAlbumVersions.length>0)},get hasLatestGenreAlbums(){return!!(e.latestGenreAlbums.loadingState===c.Gu.IDLE||e.latestGenreAlbums.loadingState===c.Gu.PENDING||e.latestGenreAlbums.items&&e.latestGenreAlbums.items.length>0)},get hasOtherArtistAlbums(){return!!(e.otherArtistAlbums.loadingState===c.Gu.IDLE||e.otherArtistAlbums.loadingState===c.Gu.PENDING||e.otherArtistAlbums.items&&e.otherArtistAlbums.items.length>0)},get isLoading(){return e.loadingState===c.Gu.IDLE||e.loadingState===c.Gu.PENDING},get isLoaded(){return e.loadingState===c.Gu.RESOLVE},get isLatestGenreAlbumsLoading(){return e.latestGenreAlbums.loadingState===c.Gu.IDLE||e.latestGenreAlbums.loadingState===c.Gu.PENDING},get isOtherArtistAlbumsLoading(){return e.otherArtistAlbums.loadingState===c.Gu.IDLE||e.otherArtistAlbums.loadingState===c.Gu.PENDING},get isRelatedContentLoading(){return e.relatedContent.loadingState===c.Gu.IDLE||e.relatedContent.loadingState===c.Gu.PENDING},get contextMeta(){var d,u,b,v,g,A,h,p,E,x;return{id:e.meta.id,title:null===(d=e.meta)||void 0===d?void 0:d.title,coverUri:null===(u=e.meta)||void 0===u?void 0:u.coverUri,type:null===(b=e.meta)||void 0===b?void 0:b.type,year:null===(v=e.meta)||void 0===v?void 0:v.year,version:null===(g=e.meta)||void 0===g?void 0:g.version,contentWarning:null===(A=e.meta)||void 0===A?void 0:A.contentWarning,genre:null===(h=e.meta)||void 0===h?void 0:h.genre,likesCount:null===(p=e.meta)||void 0===p?void 0:p.likesCount,averageColor:null===(E=e.meta)||void 0===E?void 0:E.averageColor,available:null===(x=e.meta)||void 0===x?void 0:x.isAvailable}},get lastEpisodes(){return e.items.filter(e=>e.type!==m.lf.TEXT).slice(0,5).map(e=>e)},get lastEpisodesTrackIds(){return this.lastEpisodes.map(e=>e.id)}})).actions(e=>{let t={getLatestGenreAlbums:(0,l.ls)(function*(t){let{topResource:a,modelActionsLogger:i}=(0,l.dU)(e);if(e.latestGenreAlbums.loadingState!==c.Gu.PENDING)try{e.latestGenreAlbums.loadingState=c.Gu.PENDING;let i=yield a.getTopByGenre(t);e.latestGenreAlbums.items=(0,l.pj)(i.albums.map(r.ym)),e.latestGenreAlbums.loadingState=c.Gu.RESOLVE}catch(t){i.error(t),e.latestGenreAlbums.loadingState=c.Gu.REJECT}}),getOtherArtistAlbums:(0,l.ls)(function*(t,a){let{artistsResource:i,modelActionsLogger:s}=(0,l.dU)(e);if(e.otherArtistAlbums.loadingState!==c.Gu.PENDING)try{if(!t.artistId){e.otherArtistAlbums.loadingState=c.Gu.REJECT;return}e.otherArtistAlbums.loadingState=c.Gu.PENDING;let s=yield i.getSafeDirectAlbums({...t,artistId:t.artistId});e.otherArtistAlbums.items=(0,l.pj)(s.albums.filter(e=>String(e.id)!==String(a)).map(r.ym)),e.otherArtistAlbums.loadingState=c.Gu.RESOLVE}catch(t){s.error(t),e.otherArtistAlbums.loadingState=c.Gu.REJECT}}),getTracks:(0,l.ls)(function*(t){let{trackIds:a}=t,{tracksResource:i,modelActionsLogger:s}=(0,l.dU)(e);try{var n;if(!(null===(n=e.meta)||void 0===n?void 0:n.id))return;S(a,e.items,e.indexItems,c.Gu.PENDING);let t=yield i.getTracksMeta({trackIds:v(a,e.meta.id),withProgress:!0});x(t,e.items,e.indexItems,e.meta.bestAlbumTracks)}catch(t){s.error(t),S(a,e.items,e.indexItems,c.Gu.REJECT)}}),getDonations:(0,l.ls)(function*(t){let{albumId:a}=t,{experiments:i}=(0,l.yj)(e),{donationResource:s,modelActionsLogger:n}=(0,l.dU)(e);if(i.checkExperiment(c.pe.WebNextAlbumDonateChooserButton,"on")&&e.donations.loadingState!==c.Gu.PENDING)try{e.donations.loadingState=c.Gu.PENDING;let{donations:t}=yield s.getAlbumDonations({albumId:a});t&&(e.donations.items=(0,l.pj)(t.map(d.fv))),e.donations.loadingState=c.Gu.RESOLVE}catch(t){n.error(t),e.donations.loadingState=c.Gu.REJECT}}),getData:(0,l.ls)(function*(a){let{albumId:i,resumeStream:o}=a,{albumResource:d,modelActionsLogger:m}=(0,l.dU)(e),{experiments:b,disclaimer:v}=(0,l.yj)(e),g=b.checkExperiment(c.pe.WebNextAlbumDisableVersions,"on"),A=b.checkExperiment(c.pe.WebNextAlbumDisableTracks,"on"),h=b.checkExperiment(c.pe.WebNextAlbumDisableLatestGenreAlbums,"on"),p=b.checkExperiment(c.pe.WebNextAlbumDisableOtherArtistAlbums,"on"),E=b.checkExperiment(c.pe.WebNextLegalRejectAlbum,"on");if(e.id=i,e.loadingState!==c.Gu.PENDING)try{var x,N,S,I;let a,m;e.loadingState=c.Gu.PENDING;let b=yield d.getAlbumWithTracksIds({albumId:i,resumeStream:o});if((null==b?void 0:b.error)==="not-found"){e.errorStatusCode=s.CN.NOT_FOUND,e.loadingState=c.Gu.REJECT,e.otherArtistAlbums.loadingState=c.Gu.REJECT,e.latestGenreAlbums.loadingState=c.Gu.REJECT;return}if(null===(x=b.deprecation)||void 0===x?void 0:x.targetAlbumId){e.deprecationTargetAlbumId=b.deprecation.targetAlbumId,e.loadingState=c.Gu.RESOLVE;return}(null!==(N=b.disclaimers)&&void 0!==N?N:[]).includes(n.em.MODAL)&&E&&(yield v.getAlbumDisclaimer({albumId:i}));let{sonataState:f}=(0,l.yj)(e);if(f.setUnloadedEntitiesData(b.volumes.flat().map(e=>(0,u.RN)(e.id))),e.meta=(0,r.ym)(b),e.labels=(0,l.pj)(b.labels),e.contentWarning=(0,l.pj)(b.contentWarning),e.description=(0,l.pj)(b.description),!g&&b.duplicates&&b.duplicates.length>0&&(e.otherAlbumVersions=(0,l.pj)(null===(S=b.duplicates)||void 0===S?void 0:S.map(r.ym))),!A){C(b,e.items,e.indexItems,e.trackIndexInContext);let a=[];for(let t=0;t<10;t++){let i=e.items[t];(null==i?void 0:i.type)===n.Vc.TRACK&&a.push(String(i.id))}yield t.getTracks({trackIds:a})}!h&&e.isLatestGenreAlbumsAvailable?a=t.getLatestGenreAlbums({category:n.mk.RECENT_ALBUMS,period:n.pH.WEEK,pageSize:8,genre:b.genre}):e.latestGenreAlbums.loadingState=c.Gu.RESOLVE,!p&&e.isOtherArtistAlbumsAvailable?m=t.getOtherArtistAlbums({artistId:String(null===(I=b.artists[0])||void 0===I?void 0:I.id),limit:8},i):e.otherArtistAlbums.loadingState=c.Gu.RESOLVE,yield Promise.allSettled([a,m]),e.loadingState!==c.Gu.IDLE&&(e.loadingState=c.Gu.RESOLVE)}catch(t){m.error(t),t instanceof s.du&&(t.statusCode===s.CN.NOT_FOUND||t.statusCode===s.CN.BAD_REQUEST)&&(e.errorStatusCode=s.CN.NOT_FOUND),e.loadingState!==c.Gu.IDLE&&(e.loadingState=c.Gu.REJECT,e.otherArtistAlbums.loadingState=c.Gu.REJECT,e.latestGenreAlbums.loadingState=c.Gu.REJECT)}}),loadLastEpisodes(){t.getTracks({trackIds:e.lastEpisodesTrackIds})},getRelatedContent:(0,l.ls)(function*(){let{albumResource:t,modelActionsLogger:a}=(0,l.dU)(e);if(e.relatedContent.loadingState!==c.Gu.PENDING)try{var i,s;if(!(null===(i=e.meta)||void 0===i?void 0:i.id))return;e.relatedContent.loadingState=c.Gu.PENDING;let a=yield t.getRelatedContent({albumId:e.meta.id});e.relatedContent.items=(0,l.pj)(null===(s=a.blocks)||void 0===s?void 0:s.map(N)),e.relatedContent.loadingState=c.Gu.RESOLVE}catch(t){a.error(t),e.relatedContent.loadingState=c.Gu.REJECT}}),reset(){let{sonataState:t}=(0,l.yj)(e);t.resetUnloadedEntitiesData(),e.id=null,e.meta=null,e.errorStatusCode=null,e.deprecationTargetAlbumId=null,e.items=(0,l.pj)([]),e.indexItems.clear(),e.trackIndexInContext.clear(),e.loadingState=c.Gu.IDLE,e.donations.loadingState=c.Gu.IDLE,e.donations.items=null,e.latestGenreAlbums.loadingState=c.Gu.IDLE,e.latestGenreAlbums.items=(0,l.pj)([]),e.otherArtistAlbums.loadingState=c.Gu.IDLE,e.otherArtistAlbums.items=(0,l.pj)([]),e.otherAlbumVersions=(0,l.pj)([]),e.description="",e.labels=null,e.relatedContent.loadingState=c.Gu.IDLE,e.relatedContent.items=null}};return t})},74488:function(e,t,a){"use strict";a.d(t,{AlbumNotFoundPage:function(){return r}});var i=a(9753),l=a(9544),s=a(98639),n=a(23948),o=a(44367);let r=(0,l.Pi)(()=>{let{album:e}=(0,o.oR)();return(0,s.useEffect)(()=>{e.reset()},[]),(0,i.jsx)(n.T,{})})},93289:function(e,t,a){"use strict";a.d(t,{AlbumPage:function(){return P}});var i,l,s=a(9753),n=a(9544),o=a(74717),r=a(98639),d=a(80542),u=a(70171),m=a(68106),c=a(93490),b=a(5293),v=a(20121),g=a(44367),A=a(67868),h=a(60836),p=a(31014),E=a(23881),x=a(84338),C=a(59131),N=a(2570),S=a(88393),I=a(10064),f=a(75545),G=a(38360),L=a(28417),k=a.n(L);let _=(0,n.Pi)(e=>{var t,a,i;let{albumHeaderRef:l,refCallback:n}=e,o=(0,r.useRef)(null),u=(0,g.x5)({pageId:g.Rh.ALBUM,blockId:g.aU.ALBUM}),m=(0,r.useRef)(0),{notify:b}=(0,g.d$)(),{album:v,experiments:L,sonataState:_}=(0,g.oR)(),{formatMessage:R}=(0,d.Z)(),[T,V]=(0,r.useState)(!1);(0,r.useEffect)(()=>()=>{m.current=0},[v]),(0,r.useEffect)(()=>{(v.otherArtistAlbums.loadingState===g.Gu.REJECT||v.latestGenreAlbums.loadingState===g.Gu.REJECT)&&m&&!(m.current>0)&&(b((0,s.jsx)(A.Q,{error:R({id:"album-errors.error-during-loading-similar-albums"})}),{containerId:g.W$.ERROR}),m.current++)},[v.isNotFound,v.latestGenreAlbums.loadingState,v.otherArtistAlbums.loadingState,R,b]),(0,r.useEffect)(()=>{v.isLoaded&&v.hasOtherAlbumVersions&&V(!0)},[v.hasOtherAlbumVersions,v.isLoaded]);let j=(0,r.useCallback)(()=>{let e=o.current;null==e||e.scrollIntoView({behavior:"smooth"})},[]),y=(0,r.useMemo)(()=>{if(L.checkExperiment(g.pe.WebNextAlbumDonateChooserButton,"on")&&v.donations.items&&v.donations.items.length){var e,t;return(0,s.jsx)(I.J,{shouldShowModal:Number(null===(t=v.meta)||void 0===t?void 0:null===(e=t.artists)||void 0===e?void 0:e.length)>1,donations:v.donations.items})}return null},[v.donations.items,null===(a=v.meta)||void 0===a?void 0:null===(t=a.artists)||void 0===t?void 0:t.length,L]),D=(0,r.useMemo)(()=>v.isLoading||!v.meta||v.isRejected?(0,s.jsx)(S.KC,{className:k().header,isActive:!0}):(0,s.jsx)(S.hx,{album:v.meta,actionButton:y,className:k().header,ref:l,onVersionClick:T?j:void 0}),[y,v.isLoading,v.isRejected,v.meta,l,j,T]),O=(0,r.useMemo)(()=>({Header:()=>D,Footer:()=>(0,s.jsxs)("div",{className:k().footerContainer,children:[(0,s.jsxs)("div",{className:k().carouselBlocks,children:[v.hasOtherAlbumVersions&&(0,s.jsx)(c.wk,{isShimmerVisible:v.isLoading,isShimmerActive:!0,className:k().carouselContainer,headerClassName:(0,h.W)(k().carouselBlock,k().carouselBlockHeader),containerClassName:k().carouselBlock,title:R({id:"entity-names.other-album-versions"}),albums:v.otherAlbumVersions,...(0,E.BA)(E.Br.album.OTHER_VERSIONS_CAROUSEL),headingRef:o}),v.hasLatestGenreAlbums&&(0,s.jsx)(c.wk,{isShimmerVisible:v.isLatestGenreAlbumsLoading,isShimmerActive:!0,className:k().carouselContainer,headerClassName:(0,h.W)(k().carouselBlock,k().carouselBlockHeader),containerClassName:k().carouselBlock,title:R({id:"entity-names.new-albums-in-genre"}),albums:v.latestGenreAlbums.items,...(0,E.BA)(E.Br.album.GENRE_ALBUMS_CAROUSEL)}),v.hasOtherArtistAlbums&&(0,s.jsx)(c.wk,{isShimmerVisible:v.isOtherArtistAlbumsLoading,isShimmerActive:!0,className:k().carouselContainer,headerClassName:(0,h.W)(k().carouselBlock,k().carouselBlockHeader),containerClassName:k().carouselBlock,title:R({id:"entity-names.other-albums-of-artist"}),albums:v.otherArtistAlbums.items,...(0,E.BA)(E.Br.album.OTHER_ARTIST_ALBUMS_CAROUSEL)})]}),(0,s.jsx)(A.$_,{className:k().footer})]})}),[D,v.hasOtherAlbumVersions,v.isLoading,v.otherAlbumVersions,v.hasLatestGenreAlbums,v.isLatestGenreAlbumsLoading,v.latestGenreAlbums.items,v.hasOtherArtistAlbums,v.isOtherArtistAlbumsLoading,v.otherArtistAlbums.items,R]),P=(0,r.useCallback)(e=>{let t=[];for(let a=e.startIndex;a<=e.endIndex;a++){let e=v.items[a];(null==e?void 0:e.type)===C.Vc.TRACK&&(null==e?void 0:e.loadingState)===g.Gu.IDLE&&t.push(e.id)}t.length&&v.getTracks({trackIds:t})},[v]),B=L.checkExperiment(g.pe.WebNextAlbumDisableTracks,"on")?0:v.items.length||10;return(0,s.jsx)(A.Wv,{className:(0,h.W)(k().root,k().important),listClassName:k().content,context:{listAriaLabel:R({id:"entity-names.albums-tracks-list"},{albumName:(null===(i=v.meta)||void 0===i?void 0:i.title)||""})},customComponents:O,totalCount:B,itemContentCallback:e=>{var t,a;let i=null==v?void 0:null===(t=v.items)||void 0===t?void 0:t[e];if(!i||!v.meta||v.isRejected)return(0,s.jsx)(A.DX,{isActive:!0,className:k().shimmerItem,variant:g.Lx.ALBUM});if(!(null==i?void 0:i.data))switch(null==i?void 0:i.type){case G.lf.TEXT:return(0,s.jsx)(A.AH,{className:k().shimmerItem});case C.Vc.TRACK:return(0,s.jsx)(A.DX,{isActive:!0,className:k().shimmerItem,variant:g.Lx.ALBUM})}return(null==i?void 0:i.type)===G.lf.TEXT?(0,s.jsx)("div",{className:(0,h.W)(k().shimmerItem,k().textItem),children:(0,s.jsx)(N.Heading,{variant:"h3",className:k().text,children:(0,s.jsx)(p.Z,{id:"entity-names.disk-number",values:{number:i.data}})})}):i.data?(0,s.jsx)(f.RJ,{withLightning:i.isBest,track:i.data,position:i.position,albumArtists:null==v?void 0:null===(a=v.meta)||void 0===a?void 0:a.artists,playContextParams:{contextData:{type:x.Ak.Album,meta:v.contextMeta,from:u},queueParams:{index:v.trackIndexInContext.get(String(i.id))},loadContextMeta:!0,entitiesData:_.unloadedEntitiesDataFromModels}}):void 0},onGetDataByRange:P,debounceDurationInMs:300,initialItemCount:B,handleRef:n,withHeader:!0,testId:E.Br.album.ALBUM_PAGE})});var R=a(14102),T=a(82857);(i=l||(l={})).ABOUT="about",i.TRACKS="track-list";let V=[l.ABOUT,l.TRACKS],j=e=>{let{formatMessage:t}=(0,d.Z)(),a=Math.floor(e/60%60),i=Math.floor(e/60/60),l="";return i>0&&(l+=t({id:"time.hours"},{hours:i})),a>0&&(l+=(l.length>0?" ":"")+t({id:"time.minutes-left"},{minutes:a})),l};var y=a(55447),D=a.n(y);let O=(0,n.Pi)(e=>{var t,a,i,n,u,m,c,b;let{nonMusicHeaderRef:v,refCallback:E}=e,I=(0,r.useRef)(0),L=(0,r.useRef)(null),{album:_,experiments:y,sonataState:O}=(0,g.oR)(),P=(null===(t=_.meta)||void 0===t?void 0:t.isAudiobook)?g.Rh.AUDIOBOOK:g.Rh.PODCAST,B=(null===(a=_.meta)||void 0===a?void 0:a.isAudiobook)?g.aU.AUDIOBOOK:g.aU.PODCAST,M=(0,g.x5)({pageId:P,blockId:B}),U=y.checkExperiment(g.pe.WebNextPodcastPage,"on"),W=(0,r.useId)(),{formatMessage:H}=(0,d.Z)(),F=(0,o.useSearchParams)(),J=(0,g.m5)(),w=(0,r.useMemo)(()=>{if(!U)return null;let e=F.get(g.wx.ACTIVE_TAB),t=V.findIndex(t=>t===e);return t>=0?t:null},[F,U]),X=(0,R.useTabsState)(null!=w?w:0),[K,Z]=(0,r.useState)(V[X.value]);(0,r.useEffect)(()=>()=>{I.current=0},[_]);let $=(0,r.useMemo)(()=>{var e;return(null===(e=_.meta)||void 0===e?void 0:e.isAudiobook)?{about:H({id:"non-music.audiobook-tab-about"}),"track-list":H({id:"non-music.audiobook-tab-tracks"})}:{about:H({id:"podcast.tab-about"}),"track-list":H({id:"podcast.tab-tracks"},{value:_.items.length})}},[null===(i=_.meta)||void 0===i?void 0:i.isAudiobook,_.items.length,H]),z=(0,r.useMemo)(()=>e=>{var t;if(!X.onTabChange||e===X.value)return;X.onTabChange(e);let a=null!==(t=V[e])&&void 0!==t?t:l.ABOUT;Z(a);let i=(0,g.rd)(g.wx.ACTIVE_TAB,a);i&&J(i),setTimeout(()=>{var t,a,i;null===(i=L.current)||void 0===i||null===(a=i.children[e])||void 0===a||null===(t=a.focus)||void 0===t||t.call(a)})},[X,J]),Q=(e,t)=>(0,s.jsxs)("div",{className:D().infoBlock,children:[(0,s.jsx)(N.Caption,{variant:"span",type:"entity",size:"m",className:D().infoTitle,children:e}),(0,s.jsx)(N.Caption,{variant:"span",type:"entity",size:"m",children:t})]}),q=(0,r.useMemo)(()=>{var e,t,a,i,l,n,o,r,d,u,m,c,b,v,g,A,h;let p=Number(null===(e=_.labels)||void 0===e?void 0:e.length)>1?H({id:"podcast.publishers-title"}):H({id:"podcast.publisher-title"}),E=null===(t=_.labels)||void 0===t?void 0:t.map(e=>e.name).join(", "),x=H({id:"podcast.age-limit"}),C=Number(null===(i=_.meta)||void 0===i?void 0:null===(a=i.artists)||void 0===a?void 0:a.length)>1?H({id:"non-music.audiobook-artists"}):H({id:"non-music.audiobook-artist"}),S=null===(n=_.meta)||void 0===n?void 0:null===(l=n.artists)||void 0===l?void 0:l.map(e=>e.name).join(", "),I=(null===(r=_.meta)||void 0===r?void 0:null===(o=r.artists)||void 0===o?void 0:o.length)||(null===(d=_.meta)||void 0===d?void 0:d.durationSec)||(null===(u=_.labels)||void 0===u?void 0:u.length)||_.isExplicit,f=Q("".concat(C,":"),String(S)),G=(null===(m=_.meta)||void 0===m?void 0:m.durationSec)&&Q("".concat(H({id:"time.duration"}),":"),"".concat(j(null===(c=_.meta)||void 0===c?void 0:c.durationSec))),L=Q("".concat(p,":"),String(E)),T=Q("".concat(x,":"),"18+");return(0,s.jsx)(R.TabPanel,{name:0,value:X.value,elementId:W,children:(0,s.jsxs)("div",{className:D().contentAbout,children:[!!(null===(b=_.description)||void 0===b?void 0:b.length)&&(0,s.jsx)(N.Caption,{variant:"div",type:"entity",size:"m",className:k().text,children:(0,s.jsx)("span",{dangerouslySetInnerHTML:{__html:_.description}})}),I&&(0,s.jsxs)("div",{className:k().text,children:[!!(null===(g=_.meta)||void 0===g?void 0:null===(v=g.artists)||void 0===v?void 0:v.length)&&f,(null===(A=_.meta)||void 0===A?void 0:A.durationSec)&&G,!!(null===(h=_.labels)||void 0===h?void 0:h.length)&&L,_.isExplicit&&T]})]})})},[H,_.isExplicit,_.labels,_.description,null===(n=_.meta)||void 0===n?void 0:n.artists,null===(u=_.meta)||void 0===u?void 0:u.durationSec,X.value,W]),Y=(0,r.useMemo)(()=>_.isLoading||!_.meta||_.isRejected?(0,s.jsx)(S.KC,{className:k().header,isActive:!0}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S.HZ,{album:_.meta,className:k().header,ref:v}),U&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(A.no,{className:D().tabCarousel,...X,onTabChange:z,ref:L,children:V.map((e,t)=>(0,s.jsx)(A.OK,{className:D().tab,title:$[e],value:t},e))}),q]})]}),[_.isLoading,_.isRejected,_.meta,q,U,v,X,$,z]);(0,r.useEffect)(()=>{_.isLoaded&&(_.loadLastEpisodes(),_.getRelatedContent())},[_,_.isLoaded,_.loadLastEpisodes,_.getRelatedContent]);let ee=y.checkExperiment(g.pe.WebNextPodcastPage,"on")&&K===l.ABOUT&&(null===(m=_.meta)||void 0===m?void 0:m.isPodcast)&&_.lastEpisodes.length>0,et=y.checkExperiment(g.pe.WebNextPodcastPage,"on")&&K===l.ABOUT&&_.relatedContent.items&&_.relatedContent.items.length>0,ea=(0,r.useMemo)(()=>({Header:()=>Y,Footer:()=>(0,s.jsxs)("div",{className:k().footerContainer,children:[ee&&(0,s.jsx)(T.QG,{className:D().lastEpisodes}),et&&(0,s.jsx)(T.$W,{isShimmerVisible:_.isRelatedContentLoading,isShimmerActive:!0}),(0,s.jsx)(A.$_,{className:k().footer})]})}),[Y,ee,et,_.isRelatedContentLoading]),ei=(0,r.useCallback)(e=>{let t=[];for(let a=e.startIndex;a<=e.endIndex;a++){let e=_.items[a];(null==e?void 0:e.type)===C.Vc.TRACK&&(null==e?void 0:e.loadingState)===g.Gu.IDLE&&t.push(e.id)}t.length&&_.getTracks({trackIds:t})},[_]),el=y.checkExperiment(g.pe.WebNextAlbumDisableTracks,"on")||U&&K===l.ABOUT?0:_.items.length||10,es=(0,r.useMemo)(()=>{if(U&&K===l.TRACKS){var e,t,a;return(null===(e=_.meta)||void 0===e?void 0:e.isAudiobook)?{listAriaLabel:H({id:"non-music.audiobook-list"},{albumName:(null===(a=_.meta)||void 0===a?void 0:a.title)||""}),listRole:"tabpanel"}:{listAriaLabel:H({id:"podcast.episodes-list"},{albumName:(null===(t=_.meta)||void 0===t?void 0:t.title)||""}),listRole:"tabpanel"}}return null},[K,null===(c=_.meta)||void 0===c?void 0:c.title,null===(b=_.meta)||void 0===b?void 0:b.isAudiobook,H,U]);return(0,s.jsx)(A.Wv,{className:(0,h.W)(k().root,k().important),listClassName:(0,h.W)(k().content,D().content),context:es,customComponents:ea,totalCount:el,itemContentCallback:e=>{var t;let a=null==_?void 0:null===(t=_.items)||void 0===t?void 0:t[e];if(!a||!_.meta||_.isRejected)return(0,s.jsx)(A.DX,{isActive:!0,className:k().shimmerItem,variant:g.Lx.ALBUM});if(!(null==a?void 0:a.data))switch(null==a?void 0:a.type){case G.lf.TEXT:return(0,s.jsx)(A.AH,{className:k().shimmerItem});case C.Vc.TRACK:return(0,s.jsx)(A.DX,{isActive:!0,className:k().shimmerItem,variant:g.Lx.ALBUM});default:return(0,s.jsx)(A.DX,{isActive:!0,className:D().shimmerItem,variant:g.Lx.PLAYLIST})}return(null==a?void 0:a.type)===G.lf.TEXT?(0,s.jsx)("div",{className:(0,h.W)(k().shimmerItem,k().textItem),children:(0,s.jsx)(N.Heading,{variant:"h3",className:k().text,children:(0,s.jsx)(p.Z,{id:"entity-names.season-number",values:{number:a.data}})})}):a.data?(0,s.jsx)(f.FP,{track:a.data,viewType:f.cO.ALBUM,position:a.position,playContextParams:{contextData:{type:x.Ak.Album,meta:_.contextMeta,from:M},queueParams:{index:_.trackIndexInContext.get(String(a.id))},loadContextMeta:!1,entitiesData:O.unloadedEntitiesDataFromModels}}):void 0},onGetDataByRange:ei,debounceDurationInMs:300,initialItemCount:el,handleRef:E,withHeader:!0})}),P=(0,n.Pi)(e=>{var t,a,i,l;let{albumId:n}=e,h=(0,r.useRef)(0),[p,E]=(0,b.zU)(),{notify:x}=(0,g.d$)(),{album:C,disclaimer:N}=(0,g.oR)(),{formatMessage:S}=(0,d.Z)(),{ref:I,offsetY:f}=(0,u.e)(),G=(0,r.useMemo)(()=>{var e;return(0,g.XG)(null===(e=C.meta)||void 0===e?void 0:e.averageColor)},[null===(t=C.meta)||void 0===t?void 0:t.averageColor]),[L,R]=(0,b.at)(G,f),{href:T}=(0,g.zB)("/album/".concat(C.deprecationTargetAlbumId)),V=(0,c.jV)({album:C.meta,shouldHistoryBack:!0}),j=(0,g.RV)();if((0,r.useEffect)(()=>{var e;(null===(e=C.meta)||void 0===e?void 0:e.isUnsafeLegal)&&V()},[null===(a=C.meta)||void 0===a?void 0:a.isUnsafeLegal,V]),(0,r.useEffect)(()=>()=>{C.reset()},[C,n]),n&&C.loadingState===g.Gu.IDLE){let e=Promise.allSettled([C.getData({albumId:Number(n),resumeStream:!1}),C.getDonations({albumId:Number(n)})]);(0,r.use)(e)}C.deprecationTargetAlbumId&&(0,o.redirect)(T),(0,r.useMemo)(()=>()=>{if(!C.isNotFound&&(C.isRejected||!C.meta&&!C.isLoading)){var e;if(!h||h.current>0)return;let t=(null===(e=C.meta)||void 0===e?void 0:e.isPodcast)?S({id:"podcast-errors.error-during-loading-podcast"}):S({id:"album-errors.error-during-loading-album"});x((0,s.jsx)(A.Q,{error:t}),{containerId:g.W$.ERROR}),h.current++}},[C.isRejected,C.isNotFound,C.meta,C.isLoading,x,S])(),(0,g.NO)(C.loadingState===g.Gu.RESOLVE),C.isNotFound&&(0,o.notFound)();let y=(0,r.useMemo)(()=>{var e;return(null===(e=C.meta)||void 0===e?void 0:e.isNonMusic)&&j?(0,s.jsx)(O,{nonMusicHeaderRef:I,refCallback:E}):(0,s.jsx)(_,{albumHeaderRef:I,refCallback:E})},[null===(i=C.meta)||void 0===i?void 0:i.isNonMusic,j,I,E]);return(null===(l=C.meta)||void 0===l?void 0:l.isLegalRejected)?N.isRejected?(0,s.jsx)(m.D,{}):(0,s.jsx)(v.em,{disclaimer:N}):(0,s.jsx)(g.Lh,{pageId:g.Rh.ALBUM,children:(0,s.jsxs)(b.I7,{scrollElement:p,children:[(0,s.jsx)(A.h4,{style:R}),(0,s.jsx)("div",{className:k().averageColorBackground,style:L}),y]})})})},82857:function(e,t,a){"use strict";a.d(t,{QG:function(){return i.LastEpisodes},$W:function(){return l.RelatedContent},fd:function(){return o},JP:function(){return v}});var i=a(39064),l=a(54964),s=a(42288),n=a(93490);let o=s.V5.model("RelatedContentItem",{id:s.V5.string,type:s.V5.string,title:s.V5.string,albums:s.V5.array(n.ug)});var r=a(59131),d=a(75545),u=a(38360),m=a(44367);let c=s.V5.model("VolumeItemTrack",{type:s.V5.enumeration(Object.values(r.Vc)),id:s.V5.union(s.V5.string,s.V5.number),data:s.V5.maybeNull(d.le),position:s.V5.maybe(s.V5.number),isBest:s.V5.maybe(s.V5.boolean),loadingState:s.V5.enumeration(Object.values(m.Gu))}),b=s.V5.model("VolumeItemText",{type:s.V5.literal(u.lf.TEXT),data:s.V5.maybeNull(s.V5.number)}),v=s.V5.union(b,c)},39064:function(e,t,a){"use strict";a.d(t,{LastEpisodes:function(){return v}});var i=a(9753),l=a(60836),s=a(9544),n=a(98639),o=a(80542),r=a(84338),d=a(75545),u=a(44367),m=a(67868),c=a(631),b=a.n(c);let v=(0,s.Pi)(e=>{let{className:t}=e,{formatMessage:a}=(0,o.Z)(),{album:s,sonataState:c}=(0,u.oR)(),v=(0,u.x5)({pageId:u.Rh.PODCAST,blockId:u.aU.PODCAST}),g=(0,n.useMemo)(()=>s.lastEpisodes.map((e,t)=>s.isLoaded&&e.data?(0,i.jsx)(d.FP,{track:e.data,playContextParams:{contextData:{type:r.Ak.Album,meta:s.contextMeta,from:v},queueParams:{index:s.trackIndexInContext.get(String(e.id))},loadContextMeta:!1,entitiesData:c.unloadedEntitiesDataFromModels}},e.data.id):(0,i.jsx)(m.DX,{isActive:!0,className:b().shimmerItem,variant:u.Lx.ALBUM},t)),[s.lastEpisodes,s.isLoaded,s.contextMeta,s.trackIndexInContext,v,c.unloadedEntitiesDataFromModels]);return(0,i.jsxs)("div",{className:(0,l.W)(t,b().root),children:[(0,i.jsx)(m.ti,{className:b().blockHeader,title:a({id:"entity-names.podcast-last-episodes"})}),(0,i.jsx)("div",{role:"list","aria-label":a({id:"podcast.last-episodes-list"}),tabIndex:0,children:g})]})})},54964:function(e,t,a){"use strict";a.d(t,{RelatedContent:function(){return v}});var i=a(9753),l=a(60836),s=a(9544),n=a(23881),o=a(93490),r=a(44367),d=a(67868);let u={AUTHORS_BOOKS:"authors-books",CATEGORY_ALBUMS:"category-albums",LABELS_ALBUMS:"labels-albums",SIMILAR_ALBUMS:"similar-albums"},m=e=>{let t=Object.keys(u).find(t=>u[t]===e);return n.QM.album[t]||""};var c=a(38359),b=a.n(c);let v=(0,s.Pi)(e=>{var t,a;let{isShimmerVisible:s,isShimmerActive:u,className:c}=e,{album:v}=(0,r.oR)();return(0,i.jsx)("div",{className:(0,l.W)(c,b().root),children:null===(a=v.relatedContent)||void 0===a?void 0:null===(t=a.items)||void 0===t?void 0:t.map((e,t)=>{let a=m(e.type);return(0,i.jsx)(d.HY,{title:e.title,isShimmerVisible:s,isShimmerActive:u,className:(0,l.W)(b().root,c),containerClassName:b().carousel,headerClassName:b().header,...a?(0,n.BA)(a):{},children:e.albums.map(e=>(0,i.jsx)(o.rf,{album:e,contentLinesCount:3,withLikesCount:!0,withAddition:!1},e.id))},"".concat(e.type).concat(t))})})})},28417:function(e){e.exports={root:"AlbumPage_root__RMrFx",important:"AlbumPage_important__x2o8I",averageColorBackground:"AlbumPage_averageColorBackground__PmVaF",header:"AlbumPage_header__TDpqp",content:"AlbumPage_content__1JXxB",footerContainer:"AlbumPage_footerContainer__1IxWF",carouselBlocks:"AlbumPage_carouselBlocks__VIvNT",carouselBlock:"AlbumPage_carouselBlock__oWYmS",carouselBlockHeader:"AlbumPage_carouselBlockHeader__Bb3Ts",carouselContainer:"AlbumPage_carouselContainer__9clXz",textItem:"AlbumPage_textItem__1T3qL",text:"AlbumPage_text__rCU1L",shimmerItem:"AlbumPage_shimmerItem___Yecm",footer:"AlbumPage_footer__6_0Ei"}},55447:function(e){e.exports={tabCarousel:"NonMusicContent_tabCarousel__EBHWC",tab:"NonMusicContent_tab__LIh_U",contentAbout:"NonMusicContent_contentAbout__BMIP5",infoBlock:"NonMusicContent_infoBlock__IyjXA",infoTitle:"NonMusicContent_infoTitle__Wf9EC",content:"NonMusicContent_content__8Q0I8",lastEpisodes:"NonMusicContent_lastEpisodes__Xa8Xp"}},631:function(e){e.exports={root:"LastEpisodes_root__4JPKj",blockHeader:"LastEpisodes_blockHeader__se7bd",shimmerItem:"LastEpisodes_shimmerItem__Iirx5"}},38359:function(e){e.exports={root:"RelatedContent_root__Dl1Nr",carousel:"RelatedContent_carousel__pmv5c",header:"RelatedContent_header__527S3"}}}]);