(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8525],{38525:function(e,t,a){"use strict";a.d(t,{MusicHistoryPage:function(){return E}});var i=a(9753),r=a(60836),n=a(9544),s=a(98639),o=a(31014),l=a(23881),c=a(41055),d=a(14102),u=a(2570),m=a(61134),v=a(68106),h=a(55784),x=a(63394),y=a(67868),p=a(78507);let b=e=>{let{children:t}=e,a=(0,s.useRef)({}),r=(0,s.useMemo)(()=>(0,p.wE)(e=>{var t,i;let r=(0,p.SG)(e.target),n=a.current[r];e.isIntersecting?null==n||null===(t=n.onShow)||void 0===t||t.call(n):null==n||null===(i=n.onHide)||void 0===i||i.call(n)}),[]);(0,s.useEffect)(()=>()=>null==r?void 0:r.disconnect(),[r]);let n=(0,s.useCallback)(e=>{!a.current[e.elementId]&&e.elementRef.current&&(null==r||r.observe(e.elementRef.current),a.current[e.elementId]=e)},[r]),o=(0,s.useCallback)(e=>{let t=a.current[e];t&&t.elementRef.current&&(null==r||r.unobserve(t.elementRef.current))},[r]),l=(0,s.useMemo)(()=>({observeElement:n,unobserveElement:o}),[n,o]);return(0,i.jsx)(m.ee.Provider,{value:l,children:t})},S=async(e,t)=>new Promise(a=>{if("onscrollend"in window){var i;let r=()=>{var e;a(),null===(e=t.current)||void 0===e||e.removeEventListener("scrollend",r)};null===(i=t.current)||void 0===i||i.addEventListener("scrollend",r),e.scrollIntoView({behavior:"smooth"})}else e.scrollIntoView({behavior:"smooth"}),window.setTimeout(a,1e3)});var k=a(75930),g=a.n(k),_=a(90679),f=a(83666),j=a.n(f);let I=e=>{let{isActive:t}=e,a=(0,i.jsxs)("div",{className:j().trackListShimmers,children:[(0,i.jsx)(y.DX,{isActive:t,variant:x.Lx.PLAYLIST}),(0,i.jsx)(y.DX,{isActive:t,variant:x.Lx.PLAYLIST}),(0,i.jsx)(y.DX,{isActive:t,variant:x.Lx.PLAYLIST})]});return(0,i.jsxs)("div",{className:j().shimmersContainer,children:[(0,i.jsx)(_.Shimmer,{isActive:t,className:j().dateShimmer}),(0,i.jsx)(_.Shimmer,{isActive:t,className:j().contextNameShimmer}),(0,i.jsx)(y.XM,{withDescription:!0,className:j().contextHeaderShimmer}),a,(0,i.jsx)(_.Shimmer,{isActive:t,className:j().contextNameShimmer}),(0,i.jsx)(y.XM,{coverRadius:"round",className:j().contextHeaderShimmer}),a]})},E=(0,n.Pi)(()=>{let{musicHistory:e}=(0,x.oR)(),t=(0,d.useTabsState)(0),a=(0,s.useRef)(!1),n=(0,s.useRef)(null),p=(0,s.useCallback)(async i=>{var r;let s=e.dates[i];if(!s)return;null===(r=t.onTabChange)||void 0===r||r.call(t,i),a.current=!0;let o=document.querySelector('[data-date-anchor="'.concat(s,'"]'));o&&await S(o,n),a.current=!1},[e.dates,t]);e.loadingState===x.Gu.IDLE&&(0,s.use)(e.getMusicHistory());let k=(0,s.useCallback)(()=>{if(a.current)return;let i=e.dates.findIndex(t=>e.datesMap.get(t));if(i>=0){var r;null===(r=t.onTabChange)||void 0===r||r.call(t,i)}},[e.dates,e.datesMap,t]);(0,s.useEffect)(()=>()=>e.reset(),[e]),(0,x.NO)(e.loadingState===x.Gu.RESOLVE);let _=(0,s.useMemo)(()=>{var t;return e.isRejected?(0,i.jsx)(v.D,{className:(0,r.W)(g().error,g().important),withBackwardControl:!1}):e.isShimmerVisible?(0,i.jsx)(I,{isActive:e.isShimmerActive}):e.isEmpty?(0,i.jsx)("div",{className:g().empty,children:(0,i.jsx)(u.Caption,{variant:"div",size:"m",weight:"normal",children:(0,i.jsx)(o.Z,{id:"music-history.empty-title"})})}):null===(t=e.tabs)||void 0===t?void 0:t.map((e,t)=>(0,i.jsx)(m.Wb,{onTabShowOrHide:k,"data-intersection-property-id":e.date,tab:e,tabIndex:t},t))},[k,e.isEmpty,e.isRejected,e.isShimmerActive,e.isShimmerVisible,e.tabs]),f=(0,m.e8)();return(0,i.jsx)(x.Lh,{pageId:x.Rh.HISTORY,children:(0,i.jsxs)("div",{className:g().root,...(0,l.BA)(l.Br.musicHistory.MUSIC_HISTORY_PAGE),children:[(0,i.jsxs)("div",{className:g().headerContainer,children:[(0,i.jsxs)("div",{className:g().header,children:[(0,i.jsx)(h.n,{withForwardControl:!1}),(0,i.jsx)(u.Heading,{variant:"h1",weight:"bold",size:"xl",lineClamp:1,children:(0,i.jsx)(o.Z,{id:"music-history.title"})})]}),(0,i.jsx)(y.no,{isShimmerVisible:e.isShimmerVisible,className:g().tabs,...t,onTabChange:p,shimmer:(0,i.jsx)(y.tS,{className:g().tabs,shimmerClassName:(0,r.W)(g().tab,{[g().tab_isLoading]:e.isShimmerVisible}),count:5}),children:e.dates.map((e,a)=>(0,i.jsx)(y.OK,{className:(0,r.W)(g().tab,{[g().tab_selected]:a===t.value}),titleClassName:g().date,"aria-label":f(e,!1),title:f(e,!1),value:a},a))})]}),(0,i.jsxs)(c.t,{ref:n,className:g().scroll,containerClassName:g().scrollContainer,children:[(0,i.jsx)(b,{children:(0,i.jsx)("div",{className:g().content,children:_})}),(0,i.jsx)(y.$_,{className:g().footer})]})]})})})},61134:function(e,t,a){"use strict";a.d(t,{ee:function(){return R.MusicHistoryIntersectionObserverContext},Mf:function(){return T},Wb:function(){return w.MusicHistoryTab},t9:function(){return g},un:function(){return _},H5:function(){return E},aQ:function(){return V},LV:function(){return f},R3:function(){return N},Ql:function(){return W},DF:function(){return G},v3:function(){return D},eE:function(){return O},OE:function(){return P},e8:function(){return U.useFormatDate}});var i=a(42288),r=a(69869),n=a(93490),s=a(63394),o=a(15419);let l=e=>({type:o.RX.Unloaded,meta:{id:e.entityId}});var c=a(48892);let d=i.V5.model("MusicHistoryTrack",{type:i.V5.literal(r.EW.TRACK),id:i.V5.string,data:i.V5.maybeNull(c.le),loadingState:i.V5.enumeration(Object.values(s.Gu))}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get isNeededToLoad(){return e.loadingState===s.Gu.IDLE},get isLoading(){return e.loadingState===s.Gu.PENDING},get isRejected(){return e.loadingState===s.Gu.REJECT},get isShimmerVisible(){return this.isNeededToLoad||this.isLoading||this.isRejected},get isShimmerActive(){return this.isLoading},get entityId(){var t;if(!e.data)return e.id;let{id:a,albums:i}=e.data,r=null===(t=i[0])||void 0===t?void 0:t.id;return r?"".concat(a,":").concat(r):a}})).named("MusicHistoryPlaylist"),u=i.V5.model("MusicHistoryBaseBlock",{id:i.V5.string,loadingState:i.V5.enumeration(Object.values(s.Gu)),tracks:i.V5.array(d)}).views(e=>({get isNeededToLoad(){return e.loadingState===s.Gu.IDLE},get isLoading(){return e.loadingState===s.Gu.PENDING},get isLoaded(){return e.loadingState===s.Gu.RESOLVE},get isRejected(){return e.loadingState===s.Gu.REJECT},get isShimmerVisible(){return this.isNeededToLoad||this.isLoading||this.isRejected},get isShimmerActive(){return this.isLoading},get contextId(){return e.id},get entitiesData(){return e.tracks.map(l)}})),m=u.props({type:i.V5.literal(r.EW.ALBUM),available:i.V5.boolean,meta:i.V5.maybeNull(n.ug)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get autoflowSeeds(){var t;return["album:".concat(null===(t=e.meta)||void 0===t?void 0:t.id)]}})).named("MusicHistoryAlbum");var v=a(33589);let h=u.props({type:i.V5.literal(r.EW.ARTIST),available:i.V5.boolean,meta:i.V5.maybeNull(v.Go)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get autoflowSeeds(){var t;return["artist:".concat(null===(t=e.meta)||void 0===t?void 0:t.id)]}})).named("MusicHistoryArtist"),x=i.V5.model("MusicHistoryCommon",{id:i.V5.string,type:i.V5.union(i.V5.literal(r.EW.OTHER),i.V5.literal(r.EW.SEARCH)),tracks:i.V5.array(d)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get contextId(){return e.tracks.map(e=>e.id).join(",")},get entitiesData(){return e.tracks.map(l)}}));var y=a(31579);let p=u.props({type:i.V5.literal(r.EW.PLAYLIST),meta:i.V5.maybeNull(y.d2)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get autoflowSeeds(){var t,a;return["playlist:".concat(null===(t=e.meta)||void 0===t?void 0:t.uid,"_").concat(null===(a=e.meta)||void 0===a?void 0:a.kind)]}})).named("MusicHistoryPlaylist");var b=a(40029);let S=u.props({id:i.V5.string,type:i.V5.literal(r.EW.WAVE),meta:i.V5.maybeNull(b.KW)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get contextId(){var t,a;return null!==(a=null===(t=e.meta)||void 0===t?void 0:t.stationId)&&void 0!==a?a:s.sH},get autoflowSeeds(){var i;return null===(i=e.meta)||void 0===i?void 0:i.seeds}})),k=i.V5.union(m,h,p,S,x),g=i.V5.model("MusicHistoryTab",{date:i.V5.string,blocks:i.V5.maybeNull(i.V5.array(k))}),_=e=>e.data.itemId.id,f=e=>{let{albumId:t,trackId:a}=e.data.itemId;return t?"".concat(a,":").concat(t):a},j=e=>{if("fullModel"in e.data){let{fullModel:t}=e.data;return(0,i.pj)({type:r.EW.TRACK,id:f(e),loadingState:s.Gu.RESOLVE,data:(0,c.Vt)(t)})}return(0,i.pj)({type:r.EW.TRACK,id:f(e),data:null,loadingState:s.Gu.IDLE})},I=(e,t)=>{let{data:a}=e;if("fullModel"in a){let{fullModel:o}=a;return(0,i.pj)({type:r.EW.ALBUM,available:o.available,id:_(e),meta:(0,n.cO)({album:o.album,artists:o.artists}),loadingState:s.Gu.RESOLVE,tracks:t.map(j)})}return(0,i.pj)({type:r.EW.ALBUM,available:!0,id:_(e),meta:null,loadingState:s.Gu.IDLE,tracks:t.map(j)})},E=e=>e.data.itemId.id,M=(e,t)=>{let{data:a,type:r}=e;if("fullModel"in a){let{fullModel:n}=a;return(0,i.pj)({type:r,available:n.available,id:E(e),meta:(0,v.tR)(n.artist),loadingState:s.Gu.RESOLVE,tracks:t.map(j)})}return(0,i.pj)({type:r,available:!0,id:E(e),meta:null,loadingState:s.Gu.IDLE,tracks:t.map(j)})};var A=a(3429);let C=(e,t)=>{let{type:a}=e;return(0,i.pj)({type:a,id:(0,A.Z)(),tracks:t.map(j)})},V=e=>{let{uid:t,kind:a}=e.data.itemId;return"".concat(t,":").concat(a)},L=(e,t)=>{let{data:a,type:n}=e;if("fullModel"in a){let{fullModel:r}=a;return(0,i.pj)({type:n,id:V(e),meta:{...(0,y.RE)({playlist:r.playlist}),tracksCount:r.tracksCount},loadingState:s.Gu.RESOLVE,tracks:t.map(j)})}return(0,i.pj)({type:r.EW.PLAYLIST,id:V(e),meta:null,loadingState:s.Gu.IDLE,tracks:t.map(j)})},N=e=>e.data.itemId.seeds.sort().join(","),H=(e,t)=>{let{data:a,type:r}=e;if("fullModel"in a){let{fullModel:n}=a;return(0,i.pj)({type:r,id:N(e),meta:{...(0,b.FF)(n.wave),imageUrl:n.simpleWaveForegroundImageUrl,backgroundColor:n.simpleWaveBackgroundColor},loadingState:s.Gu.RESOLVE,tracks:t.map(j)})}return(0,i.pj)({type:r,id:N(e),meta:null,loadingState:s.Gu.IDLE,tracks:t.map(j)})},P=e=>{var t,a;let n=null===(t=e.items)||void 0===t?void 0:t.map(e=>{switch(e.context.type){case r.EW.ALBUM:return I(e.context,e.tracks);case r.EW.PLAYLIST:return L(e.context,e.tracks);case r.EW.ARTIST:return M(e.context,e.tracks);case r.EW.WAVE:return H(e.context,e.tracks);case r.EW.SEARCH:case r.EW.OTHER:return C(e.context,e.tracks);default:return null}}).filter(e=>e);return{date:e.date,blocks:null!==(a=(0,i.pj)(n))&&void 0!==a?a:null}};var w=a(44860),R=a(27586);let T=i.V5.model({id:i.V5.string,type:i.V5.enumeration(Object.values(r.EW)),tabIndex:i.V5.number,blockIndex:i.V5.number,trackIndex:i.V5.maybeNull(i.V5.number),loadingState:i.V5.enumeration(Object.values(s.Gu))}).views(e=>({get isLoaded(){return e.loadingState===s.Gu.RESOLVE}})),D=e=>(null==e?void 0:e.type)===r.EW.PLAYLIST,W=e=>(null==e?void 0:e.type)===r.EW.ALBUM,O=e=>(null==e?void 0:e.type)===r.EW.WAVE,G=e=>(null==e?void 0:e.type)===r.EW.ARTIST;var U=a(61036)},27586:function(e,t,a){"use strict";a.d(t,{MusicHistoryIntersectionObserverContext:function(){return i}});let i=(0,a(98639).createContext)({observeElement:()=>{},unobserveElement:()=>{}})},61036:function(e,t,a){"use strict";a.d(t,{useFormatDate:function(){return n}});var i=a(98639),r=a(80542);let n=()=>{let{formatDate:e,formatRelativeTime:t}=(0,r.Z)();return(0,i.useCallback)(function(a){let i=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=new Date(a),n=new Date;r.setHours(0,0,0,0),n.setHours(0,0,0,0);let s=(r.getTime()-n.getTime())/864e5,o=t(s,"day",{numeric:"auto"}),l=e(a,{day:"numeric",month:"long"});switch(s){case 0:case -1:case -2:if(i)return"".concat(o,", ").concat(l);return o;default:return l}},[e,t])}},44860:function(e,t,a){"use strict";a.d(t,{MusicHistoryTab:function(){return L}});var i=a(9753),r=a(9544),n=a(98639),s=a(69869),o=a(2570),l=a(63394),c=a(27586),d=a(61036),u=a(60836),m=a(31014),v=a(84338),h=a(33589),x=a(67868);let y=e=>{let{id:t,tabIndex:a,blockIndex:i,trackIndex:r}=e,{musicHistory:s}=(0,l.oR)(),o=(0,n.useId)(),d=(0,n.useRef)(null),{observeElement:u,unobserveElement:m}=(0,n.useContext)(c.MusicHistoryIntersectionObserverContext);return(0,n.useEffect)(()=>{let e=void 0!==r?"".concat(a,"_").concat(i,"_").concat(r,"_").concat(t):"".concat(a,"_").concat(i,"_").concat(t),n=s.indexesMap.get(e);s.isInObservationRange(n)&&u({elementRef:d,elementId:o,index:n,onShow(){s.getItems(this.index),m(o)}})},[i,t,o,s,u,a,r,m]),{intersectionPropertyId:o,ref:d}};var p=a(48892),b=a(1772),S=a.n(b);let k=(0,r.Pi)(e=>{let{type:t,track:a,artists:r,tabIndex:n,blockIndex:s,trackIndex:o,playContextParams:c}=e,{ref:d,intersectionPropertyId:u}=y({id:a.id,tabIndex:n,blockIndex:s,trackIndex:o});return a.isShimmerVisible||!a.data?(0,i.jsx)("div",{"data-intersection-property-id":u,ref:d,children:(0,i.jsx)(x.DX,{isActive:a.isShimmerActive,"data-intersection-property-id":u,className:S().trackShimmer,variant:t===v.Ak.Album?l.Lx.ALBUM:l.Lx.PLAYLIST})}):t===v.Ak.Album?(0,i.jsx)(p.RJ,{track:a.data,position:a.data.index,albumArtists:r,playContextParams:c}):(0,i.jsx)(p.O2,{track:a.data,playContextParams:c})});var g=a(41710),_=a.n(g);let f=(0,r.Pi)(e=>{var t,a,r,s;let{album:c,tabIndex:d,blockIndex:p}=e,{ref:b,intersectionPropertyId:S}=y({id:c.id,tabIndex:d,blockIndex:p}),g=(0,l.x5)({blockId:"album-".concat(c.id)}),f=(0,n.useMemo)(()=>{var e,t;return c.available?(0,i.jsx)(h.jO,{className:_().artists,linkClassName:_().artistLink,artists:null===(e=c.meta)||void 0===e?void 0:e.artists,lineClamp:1}):null===(t=c.meta)||void 0===t?void 0:t.artistNames},[c.available,null===(t=c.meta)||void 0===t?void 0:t.artistNames,null===(a=c.meta)||void 0===a?void 0:a.artists]),j=(0,n.useMemo)(()=>{var e,t;return c.isShimmerVisible?(0,i.jsx)(x.XM,{isActive:c.isShimmerActive,className:_().header,withDescription:!0}):(0,i.jsx)(x.ti,{className:_().header,coverUrl:null===(e=c.meta)||void 0===e?void 0:e.coverUri,title:null===(t=c.meta)||void 0===t?void 0:t.title,titleSize:"xs",titleLineClamp:1,description:f,titleClassName:_().headerTitle,viewAllActionLink:"/album/".concat(c.id),available:c.available,fallbackIconVariant:"album",withCoverFallback:!0,headingVariant:"h4"})},[c.available,c.id,c.isShimmerActive,c.isShimmerVisible,null===(r=c.meta)||void 0===r?void 0:r.coverUri,null===(s=c.meta)||void 0===s?void 0:s.title,f]),I=(0,n.useMemo)(()=>c.tracks.map((e,t)=>{let a={contextData:{type:v.Ak.Various,meta:{id:c.contextId},from:g,overrideContextType:v.Zc.Album,overrideAutoflowSeeds:c.autoflowSeeds},queueParams:{index:t},loadContextMeta:!1,entitiesData:c.entitiesData};return(0,i.jsx)(k,{type:v.Ak.Album,track:e,playContextParams:a,tabIndex:d,blockIndex:p,trackIndex:t},"".concat(e.key,"_").concat(t))}),[c.tracks,c.contextId,c.autoflowSeeds,c.entitiesData,g,d,p]);return(0,i.jsxs)("section",{className:_().root,ref:b,"data-intersection-property-id":S,children:[(0,i.jsx)(o.Heading,{className:(0,u.W)(_().header,_().heading),variant:"h3",children:(0,i.jsx)(m.Z,{id:"music-history.album"})}),j,(0,i.jsx)("div",{className:_().content,children:I})]})}),j=(0,r.Pi)(e=>{var t,a;let{artist:r,tabIndex:s,blockIndex:c}=e,{ref:d,intersectionPropertyId:h}=y({id:r.id,tabIndex:s,blockIndex:c}),p=(0,l.x5)({blockId:"artist-".concat(r.id)}),b=(0,n.useMemo)(()=>{var e,t;return r.isShimmerVisible?(0,i.jsx)(x.XM,{isActive:r.isShimmerActive,className:_().header,coverRadius:"round"}):(0,i.jsx)(x.ti,{titleSize:"xs",titleLineClamp:1,className:_().header,coverUrl:null===(e=r.meta)||void 0===e?void 0:e.coverUri,title:null===(t=r.meta)||void 0===t?void 0:t.name,titleClassName:_().headerTitle,viewAllActionLink:"/artist/".concat(r.id),available:r.available,withCoverFallback:!0,coverRadius:"round",headingVariant:"h4"})},[r.available,r.id,r.isShimmerActive,r.isShimmerVisible,null===(t=r.meta)||void 0===t?void 0:t.coverUri,null===(a=r.meta)||void 0===a?void 0:a.name]),S=(0,n.useMemo)(()=>r.tracks.map((e,t)=>{let a={contextData:{type:v.Ak.Various,meta:{id:r.contextId},from:p,overrideAutoflowSeeds:r.autoflowSeeds,overrideContextType:v.Zc.Artist},queueParams:{index:t},loadContextMeta:!1,entitiesData:r.entitiesData};return(0,i.jsx)(k,{type:v.Ak.Artist,track:e,playContextParams:a,tabIndex:s,blockIndex:c,trackIndex:t},"".concat(e.id,"_").concat(t))}),[r.tracks,r.contextId,r.autoflowSeeds,r.entitiesData,p,s,c]);return(0,i.jsxs)("section",{className:_().root,ref:d,"data-intersection-property-id":h,children:[(0,i.jsx)(o.Heading,{className:(0,u.W)(_().header,_().heading),variant:"h3",children:(0,i.jsx)(m.Z,{id:"music-history.artist"})}),b,(0,i.jsx)("div",{className:_().content,children:S})]})}),I=(0,r.Pi)(e=>{let{common:t,tabIndex:a,blockIndex:r}=e,{ref:c,intersectionPropertyId:d}=y({id:t.id,tabIndex:a,blockIndex:r}),h=(0,l.x5)(),x=(0,n.useMemo)(()=>t.tracks.map((e,n)=>{let o={contextData:{type:v.Ak.Various,meta:{id:t.contextId},overrideContextType:t.type===s.EW.SEARCH?v.Zc.Search:v.Zc.Other,from:h},queueParams:{index:n},loadContextMeta:!1,entitiesData:t.entitiesData};return(0,i.jsx)(k,{playContextParams:o,type:v.Ak.Various,track:e,tabIndex:a,blockIndex:r,trackIndex:n},"".concat(e.id,"_").concat(n))}),[t.tracks,t.contextId,t.type,t.entitiesData,h,a,r]),p=(0,n.useMemo)(()=>{switch(t.type){case s.EW.OTHER:return(0,i.jsx)(m.Z,{id:"music-history.shuffle"});case s.EW.SEARCH:return(0,i.jsx)(m.Z,{id:"music-history.search"})}},[t.type]);return(0,i.jsxs)("section",{className:_().root,ref:c,"data-intersection-property-id":d,children:[(0,i.jsx)(o.Heading,{className:(0,u.W)(_().header,_().heading),variant:"h3",children:p}),(0,i.jsx)("div",{className:_().content,children:x})]})});var E=a(80542);let M=(0,r.Pi)(e=>{var t,a,r,s,c;let{playlist:d,tabIndex:h,blockIndex:p}=e,{ref:b,intersectionPropertyId:S}=y({id:d.id,tabIndex:h,blockIndex:p}),g=(0,l.x5)({blockId:d.isLoaded?"playlist-".concat(null===(t=d.meta)||void 0===t?void 0:t.id):""}),{formatMessage:f}=(0,E.Z)(),j=(0,n.useMemo)(()=>{var e,t,a,r;return d.isShimmerVisible?(0,i.jsx)(x.XM,{isActive:d.isShimmerActive,className:_().header,withDescription:!0}):(0,i.jsx)(x.ti,{className:_().header,titleSize:"xs",titleLineClamp:1,coverUrl:null===(e=d.meta)||void 0===e?void 0:e.coverUri,title:null===(t=d.meta)||void 0===t?void 0:t.title,titleClassName:_().headerTitle,description:f({id:"entity-names.number-of-tracks"},{counter:null===(a=d.meta)||void 0===a?void 0:a.tracksCount}),fallbackIconVariant:"playlist",withCoverFallback:!0,viewAllActionLink:"/playlist/".concat(null===(r=d.meta)||void 0===r?void 0:r.uuid),headingVariant:"h4"})},[f,d.isShimmerActive,d.isShimmerVisible,null===(a=d.meta)||void 0===a?void 0:a.coverUri,null===(r=d.meta)||void 0===r?void 0:r.title,null===(s=d.meta)||void 0===s?void 0:s.tracksCount,null===(c=d.meta)||void 0===c?void 0:c.uuid]),I=(0,n.useMemo)(()=>d.tracks.map((e,t)=>{let a={contextData:{type:v.Ak.Various,meta:{id:d.contextId},from:g,overrideAutoflowSeeds:d.autoflowSeeds,overrideContextType:v.Zc.Playlist},queueParams:{index:t},loadContextMeta:!1,entitiesData:d.entitiesData};return(0,i.jsx)(k,{playContextParams:a,type:v.Ak.Playlist,track:e,tabIndex:h,blockIndex:p,trackIndex:t},"".concat(e.id,"_").concat(t))}),[d.tracks,d.contextId,d.autoflowSeeds,d.entitiesData,g,h,p]);return(0,i.jsxs)("section",{className:_().root,ref:b,"data-intersection-property-id":S,children:[(0,i.jsx)(o.Heading,{className:(0,u.W)(_().header,_().heading),variant:"h3",children:(0,i.jsx)(m.Z,{id:"music-history.playlist"})}),j,(0,i.jsx)("div",{className:_().content,children:I})]})}),A=(0,r.Pi)(e=>{var t,a,r,s;let{vibe:c,blockIndex:d,tabIndex:h}=e,{ref:p,intersectionPropertyId:b}=y({id:c.id,blockIndex:d,tabIndex:h}),S=(0,l.x5)({blockId:"wave-".concat(c.id)}),g=(0,n.useMemo)(()=>{var e,t,a,r,n;return c.isShimmerVisible?(0,i.jsx)(x.XM,{isActive:c.isShimmerActive,className:_().header,coverRadius:"round"}):(0,i.jsx)(x.ti,{titleSize:"xs",titleLineClamp:1,className:_().header,coverUrl:null===(e=c.meta)||void 0===e?void 0:e.imageUrl,title:null!==(n=null===(t=c.meta)||void 0===t?void 0:t.title)&&void 0!==n?n:null===(a=c.meta)||void 0===a?void 0:a.header,titleClassName:_().headerTitle,coverBackgroundColor:null===(r=c.meta)||void 0===r?void 0:r.backgroundColor,coverRadius:"round",headingVariant:"h4"})},[c.isShimmerActive,c.isShimmerVisible,null===(t=c.meta)||void 0===t?void 0:t.backgroundColor,null===(a=c.meta)||void 0===a?void 0:a.header,null===(r=c.meta)||void 0===r?void 0:r.imageUrl,null===(s=c.meta)||void 0===s?void 0:s.title]),f=(0,n.useMemo)(()=>c.tracks.map((e,t)=>{let a={contextData:{type:v.Ak.Various,meta:{id:c.contextId},overrideAutoflowSeeds:c.autoflowSeeds,overrideContextType:v.Zc.Radio,from:S},queueParams:{index:t},loadContextMeta:!1,entitiesData:c.entitiesData};return(0,i.jsx)(k,{playContextParams:a,type:v.Ak.Vibe,track:e,blockIndex:d,tabIndex:h,trackIndex:t},"".concat(e.id,"_").concat(t))}),[c.tracks,c.contextId,c.autoflowSeeds,c.entitiesData,S,d,h]);return(0,i.jsxs)("section",{className:_().root,ref:p,"data-intersection-property-id":b,children:[(0,i.jsx)(o.Heading,{className:(0,u.W)(_().header,_().heading),variant:"h3",children:(0,i.jsx)(m.Z,{id:"music-history.my-vibe"})}),g,(0,i.jsx)("div",{className:_().content,children:f})]})});var C=a(58114),V=a.n(C);let L=(0,r.Pi)(e=>{let{tab:t,tabIndex:a,onTabShowOrHide:r,...u}=e,{musicHistory:m}=(0,l.oR)(),v=(0,n.useMemo)(()=>{var e;return null===(e=t.blocks)||void 0===e?void 0:e.map((e,t)=>{switch(e.type){case s.EW.ALBUM:return(0,i.jsx)(f,{album:e,blockIndex:t,tabIndex:a},"".concat(e.key,"_").concat(t));case s.EW.PLAYLIST:return(0,i.jsx)(M,{playlist:e,blockIndex:t,tabIndex:a},"".concat(e.key,"_").concat(t));case s.EW.WAVE:return(0,i.jsx)(A,{vibe:e,blockIndex:t,tabIndex:a},"".concat(e.key,"_").concat(t));case s.EW.ARTIST:return(0,i.jsx)(j,{artist:e,blockIndex:t,tabIndex:a},"".concat(e.key,"_").concat(t));case s.EW.SEARCH:case s.EW.OTHER:return(0,i.jsx)(I,{common:e,blockIndex:t,tabIndex:a},"".concat(e.key,"_").concat(t));default:return null}}).filter(e=>e)},[t.blocks,a]),h=(0,d.useFormatDate)(),x=(0,n.useRef)(null),{observeElement:y}=(0,n.useContext)(c.MusicHistoryIntersectionObserverContext);return(0,n.useEffect)(()=>{y({elementId:t.date,elementRef:x,index:0,onShow:()=>{m.setDatesMap(t.date,!0),r()},onHide:()=>{m.setDatesMap(t.date,!1),r()}})},[m,m.datesMap,y,r,t.date]),(0,i.jsxs)("div",{ref:x,"data-intersection-property-id":t.date,className:V().root,...u,children:[(0,i.jsx)(o.Heading,{"data-date-anchor":t.date,className:V().date,variant:"h2",size:"m",children:h(t.date)}),(0,i.jsx)("div",{className:V().content,children:v})]})})},75930:function(e){e.exports={root:"MusicHistoryPage_root__FYB2m",scroll:"MusicHistoryPage_scroll__ykpDX",scrollContainer:"MusicHistoryPage_scrollContainer__eemvg",headerContainer:"MusicHistoryPage_headerContainer__QG0L3",header:"MusicHistoryPage_header__dzEvD",content:"MusicHistoryPage_content__j4evw",footer:"MusicHistoryPage_footer__Vu7aC",empty:"MusicHistoryPage_empty__fQRHA",tabs:"MusicHistoryPage_tabs__v_5Zg",tab:"MusicHistoryPage_tab__WDE1e",tab_selected:"MusicHistoryPage_tab_selected__nmn8P",tab_isLoading:"MusicHistoryPage_tab_isLoading__nNqd2",date:"MusicHistoryPage_date__OV6rR",error:"MusicHistoryPage_error__9f_8i",important:"MusicHistoryPage_important__qNFO8"}},83666:function(e){e.exports={shimmersContainer:"MusicHistoryPageContentShimmer_shimmersContainer__82cj6",dateShimmer:"MusicHistoryPageContentShimmer_dateShimmer__d4_te",contextNameShimmer:"MusicHistoryPageContentShimmer_contextNameShimmer__Tzbqr",contextHeaderShimmer:"MusicHistoryPageContentShimmer_contextHeaderShimmer__Tq0PZ",trackListShimmers:"MusicHistoryPageContentShimmer_trackListShimmers__4GSp8"}},58114:function(e){e.exports={date:"MusicHistoryTab_date__Fjy3P",content:"MusicHistoryTab_content__Jt15j"}},1772:function(e){e.exports={trackShimmer:"MusicHistoryTrack_trackShimmer__yxcx9"}},41710:function(e){e.exports={header:"MusicHistoryBlock_header__sIFVC",heading:"MusicHistoryBlock_heading__HEfmk",headerTitle:"MusicHistoryBlock_headerTitle__Yhyst",content:"MusicHistoryBlock_content__S9lfi",artists:"MusicHistoryBlock_artists__AjuWP",artistLink:"MusicHistoryBlock_artistLink__yFHPE",shimmerTitle:"MusicHistoryBlock_shimmerTitle__Mx1IC"}}}]);