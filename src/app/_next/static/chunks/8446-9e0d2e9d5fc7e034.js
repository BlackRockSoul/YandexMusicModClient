(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8446],{10064:function(e,t,a){"use strict";a.d(t,{J:function(){return n.DonationButton},Ew:function(){return l},fv:function(){return o}});var i=a(42288),s=a(33589);let l=i.V5.model("Donation",{url:i.V5.string,artist:s.Go}),o=e=>(0,i.pj)({url:e.url,artist:(0,s.tR)(e.artist)});var n=a(63880)},63880:function(e,t,a){"use strict";a.d(t,{DonationButton:function(){return x}});var i=a(9753),s=a(60836),l=a(9544),o=a(98639),n=a(31014),r=a(39513),u=a(385),d=a(63394),m=a(86939),c=a(12404),b=a(2570),v=a(69590),g=a.n(v);let A=(0,l.Pi)(e=>{let{donation:t}=e,a=(0,d.s0)(t.url);return(0,i.jsxs)(u.sN,{className:g().root,isBlock:!0,onClick:a,children:[(0,i.jsx)(c.Paper,{radius:"round",className:g().cover,children:(0,i.jsx)(m.Image,{withAvatarReplace:!0,src:t.artist.coverUri,size:100,fit:"contain",className:g().image})}),(0,i.jsx)(b.Caption,{variant:"span",size:"m",weight:"medium",lineClamp:1,children:t.artist.name})]},t.url)});var h=a(35131),p=a.n(h);let x=(0,l.Pi)(e=>{let{donations:t,shouldShowModal:a,className:l}=e,{settings:m}=(0,d.oR)(),[c,b]=(0,o.useState)(!1),v=m.layout===d.t8.Mobile,[g]=t,h=(0,d.s0)(null==g?void 0:g.url),x=(0,o.useCallback)(()=>{a||h()},[h,a]),E=(0,o.useMemo)(()=>(0,i.jsx)(r.z,{size:"s",variant:"default",radius:"xxxl",color:"accent",withRipple:a,className:(0,s.W)(p().root,l),onClick:x,children:(0,i.jsx)(n.Z,{id:"donation.button-text"})}),[l,x,a]);return a?(0,i.jsx)(u.v2,{reference:E,onOpenChange:b,open:c,isMobile:v,placement:"bottom",offsetOptions:8,className:p().popover,children:t.map(e=>(0,i.jsx)(A,{donation:e},e.url))}):E})},58446:function(e,t,a){"use strict";a.d(t,{Xb:function(){return i.AlbumPage},Lf:function(){return G}});var i=a(93289);a(74488);var s=a(42288),l=a(10542),o=a(21585),n=a(38728),r=a(93490),u=a(10064),d=a(75191),m=a(38360),c=a(63394),b=a(58421);let v=(e,t)=>e.map(e=>"".concat(e,":").concat(t));var g=a(23472);let A=e=>({type:m.lf.TEXT,data:e||null}),h=(e,t,a,i,s)=>({type:(null==a?void 0:a.type)||o.Vc.TRACK,id:e,data:a||null,loadingState:t,position:i,isBest:s}),p=e=>"".concat(e,"-text"),x=e=>String(e),E=(e,t,a,i)=>{e.forEach(e=>{var s,l,o,n,r;if(null===(s=e.albums)||void 0===s?void 0:s[0]){let s=a.get(x(e.id));void 0!==s&&(t[s]=h(e.id,c.Gu.RESOLVE,(0,g.Vt)(e),null===(o=e.albums[0])||void 0===o?void 0:null===(l=o.trackPosition)||void 0===l?void 0:l.index,null==i?void 0:i.includes(Number(e.id))));let u=a.get(p(e.id));void 0!==u&&(t[u]=A(null===(r=e.albums[0])||void 0===r?void 0:null===(n=r.trackPosition)||void 0===n?void 0:n.volume))}})},N=(e,t,a,i)=>{let s=0;e.volumes.forEach(l=>{e.volumes.length>1&&l[0]&&(t.push(A()),a.set(p(l[0].id),t.length-1)),l.forEach(e=>{t.push(h(e.id,c.Gu.IDLE)),a.set(x(e.id),t.length-1),i.set(x(e.id),s),s++})})},f=(e,t,a,i)=>{e.forEach(e=>{let s=a.get(String(e));void 0!==s&&(t[s]=h(e,i))})},C=s.V5.model("AlbumDonations",{loadingState:s.V5.enumeration(Object.values(c.Gu)),items:s.V5.maybeNull(s.V5.array(u.Ew))}),I=s.V5.model("LabelItem",{id:s.V5.number,name:s.V5.string}),S=s.V5.model("RelatedAlbumsPage",{loadingState:s.V5.enumeration(Object.values(c.Gu)),items:s.V5.array(r.ug)}),G=s.V5.compose(s.V5.model("AlbumPage",{meta:s.V5.maybeNull(r.ug),items:s.V5.array(n.JP),indexItems:s.V5.map(s.V5.number),trackIndexInContext:s.V5.map(s.V5.number),loadingState:s.V5.enumeration(Object.values(c.Gu)),errorStatusCode:s.V5.maybeNull(s.V5.number),deprecationTargetAlbumId:s.V5.maybeNull(s.V5.number),latestGenreAlbums:S,otherArtistAlbums:S,otherAlbumVersions:s.V5.array(r.ug),labels:s.V5.maybeNull(s.V5.array(I)),description:s.V5.maybe(s.V5.string),donations:C}),b.ie).views(e=>({get isNonMusicType(){var t;if(null===(t=e.meta)||void 0===t?void 0:t.type)return[o.VZ.PODCAST,o.VZ.AUDIOBOOK].includes(e.meta.type);return!1},get isOtherArtistAlbumsAvailable(){var a,i,s,n;return!!(!this.isNonMusicType&&(null===(i=e.meta)||void 0===i?void 0:null===(a=i.artists)||void 0===a?void 0:a.length)===1&&!(null===(n=e.meta)||void 0===n?void 0:null===(s=n.artists[0])||void 0===s?void 0:s.various))},get isLatestGenreAlbumsAvailable(){var r;return!!(!this.isNonMusicType&&(null===(r=e.meta)||void 0===r?void 0:r.genre))},get isNotFound(){return e.loadingState===c.Gu.REJECT&&e.errorStatusCode===l.CN.NOT_FOUND},get isRejected(){return e.loadingState===c.Gu.REJECT},get hasOtherAlbumVersions(){return!!(e.loadingState===c.Gu.IDLE||e.loadingState===c.Gu.PENDING||e.otherAlbumVersions&&e.otherAlbumVersions.length>0)},get hasLatestGenreAlbums(){return!!(e.latestGenreAlbums.loadingState===c.Gu.IDLE||e.latestGenreAlbums.loadingState===c.Gu.PENDING||e.latestGenreAlbums.items&&e.latestGenreAlbums.items.length>0)},get hasOtherArtistAlbums(){return!!(e.otherArtistAlbums.loadingState===c.Gu.IDLE||e.otherArtistAlbums.loadingState===c.Gu.PENDING||e.otherArtistAlbums.items&&e.otherArtistAlbums.items.length>0)},get isLoading(){return e.loadingState===c.Gu.IDLE||e.loadingState===c.Gu.PENDING},get isLoaded(){return e.loadingState===c.Gu.RESOLVE},get isLatestGenreAlbumsLoading(){return e.latestGenreAlbums.loadingState===c.Gu.IDLE||e.latestGenreAlbums.loadingState===c.Gu.PENDING},get isOtherArtistAlbumsLoading(){return e.otherArtistAlbums.loadingState===c.Gu.IDLE||e.otherArtistAlbums.loadingState===c.Gu.PENDING},get contextMeta(){var u,d,b,v,g,A,h,p,x,E;return{id:e.meta.id,title:null===(u=e.meta)||void 0===u?void 0:u.title,coverUri:null===(d=e.meta)||void 0===d?void 0:d.coverUri,type:null===(b=e.meta)||void 0===b?void 0:b.type,year:null===(v=e.meta)||void 0===v?void 0:v.year,version:null===(g=e.meta)||void 0===g?void 0:g.version,contentWarning:null===(A=e.meta)||void 0===A?void 0:A.contentWarning,genre:null===(h=e.meta)||void 0===h?void 0:h.genre,likesCount:null===(p=e.meta)||void 0===p?void 0:p.likesCount,averageColor:null===(x=e.meta)||void 0===x?void 0:x.averageColor,available:null===(E=e.meta)||void 0===E?void 0:E.isAvailable}},get lastEpisodes(){return e.items.filter(e=>e.type!==m.lf.TEXT).slice(0,5).map(e=>e)},get lastEpisodesTrackIds(){return this.lastEpisodes.map(e=>e.id)}})).actions(e=>{let t={getLatestGenreAlbums:(0,s.ls)(function*(t){let{topResource:a,modelActionsLogger:i}=(0,s.dU)(e);if(e.latestGenreAlbums.loadingState!==c.Gu.PENDING)try{e.latestGenreAlbums.loadingState=c.Gu.PENDING;let i=yield a.getTopByGenre(t);e.latestGenreAlbums.items=(0,s.pj)(i.albums.map(r.ym)),e.latestGenreAlbums.loadingState=c.Gu.RESOLVE}catch(t){i.error(t),e.latestGenreAlbums.loadingState=c.Gu.REJECT}}),getOtherArtistAlbums:(0,s.ls)(function*(t,a){let{artistsResource:i,modelActionsLogger:l}=(0,s.dU)(e);if(e.otherArtistAlbums.loadingState!==c.Gu.PENDING)try{if(!t.artistId){e.otherArtistAlbums.loadingState=c.Gu.REJECT;return}e.otherArtistAlbums.loadingState=c.Gu.PENDING;let l=yield i.getSafeDirectAlbums({...t,artistId:t.artistId});e.otherArtistAlbums.items=(0,s.pj)(l.albums.filter(e=>String(e.id)!==String(a)).map(r.ym)),e.otherArtistAlbums.loadingState=c.Gu.RESOLVE}catch(t){l.error(t),e.otherArtistAlbums.loadingState=c.Gu.REJECT}}),getTracks:(0,s.ls)(function*(t){let{trackIds:a}=t,{tracksResource:i,modelActionsLogger:l}=(0,s.dU)(e);try{var o;if(!(null===(o=e.meta)||void 0===o?void 0:o.id))return;f(a,e.items,e.indexItems,c.Gu.PENDING);let t=yield i.getTracksMeta({trackIds:v(a,e.meta.id),withProgress:!0});E(t,e.items,e.indexItems,e.meta.bestAlbumTracks)}catch(t){l.error(t),f(a,e.items,e.indexItems,c.Gu.REJECT)}}),getDonations:(0,s.ls)(function*(t){let{albumId:a}=t,{experiments:i}=(0,s.yj)(e),{donationResource:l,modelActionsLogger:o}=(0,s.dU)(e);if(i.checkExperiment(c.pe.WebNextAlbumDonateChooserButton,"on")&&e.donations.loadingState!==c.Gu.PENDING)try{e.donations.loadingState=c.Gu.PENDING;let{donations:t}=yield l.getAlbumDonations({albumId:a});t&&(e.donations.items=(0,s.pj)(t.map(u.fv))),e.donations.loadingState=c.Gu.RESOLVE}catch(t){o.error(t),e.donations.loadingState=c.Gu.REJECT}}),getData:(0,s.ls)(function*(a){let{albumId:i,resumeStream:n}=a,{albumResource:u,modelActionsLogger:m}=(0,s.dU)(e),{experiments:b,disclaimer:v}=(0,s.yj)(e),g=b.checkExperiment(c.pe.WebNextAlbumDisableVersions,"on"),A=b.checkExperiment(c.pe.WebNextAlbumDisableTracks,"on"),h=b.checkExperiment(c.pe.WebNextAlbumDisableLatestGenreAlbums,"on"),p=b.checkExperiment(c.pe.WebNextAlbumDisableOtherArtistAlbums,"on"),x=b.checkExperiment(c.pe.WebNextLegalRejectAlbum,"on");if(e.loadingState!==c.Gu.PENDING)try{var E,f,C,I;let a,m;e.loadingState=c.Gu.PENDING;let b=yield u.getAlbumWithTracksIds({albumId:i,resumeStream:n});if((null==b?void 0:b.error)==="not-found"){e.errorStatusCode=l.CN.NOT_FOUND,e.loadingState=c.Gu.REJECT,e.otherArtistAlbums.loadingState=c.Gu.REJECT,e.latestGenreAlbums.loadingState=c.Gu.REJECT;return}if(null===(E=b.deprecation)||void 0===E?void 0:E.targetAlbumId){e.deprecationTargetAlbumId=b.deprecation.targetAlbumId,e.loadingState=c.Gu.RESOLVE;return}(null!==(f=b.disclaimers)&&void 0!==f?f:[]).includes(o.em.MODAL)&&x&&(yield v.getAlbumDisclaimer({albumId:i}));let{sonataState:S}=(0,s.yj)(e);if(S.setUnloadedEntitiesData(b.volumes.flat().map(e=>(0,d.RN)(e.id))),e.meta=(0,r.ym)(b),e.labels=(0,s.pj)(b.labels),e.contentWarning=(0,s.pj)(b.contentWarning),e.description=(0,s.pj)(b.description),!g&&b.duplicates&&b.duplicates.length>0&&(e.otherAlbumVersions=(0,s.pj)(null===(C=b.duplicates)||void 0===C?void 0:C.map(r.ym))),!A){N(b,e.items,e.indexItems,e.trackIndexInContext);let a=[];for(let t=0;t<10;t++){let i=e.items[t];(null==i?void 0:i.type)===o.Vc.TRACK&&a.push(String(i.id))}yield t.getTracks({trackIds:a})}!h&&e.isLatestGenreAlbumsAvailable?a=t.getLatestGenreAlbums({category:o.mk.RECENT_ALBUMS,period:o.pH.WEEK,pageSize:8,genre:b.genre}):e.latestGenreAlbums.loadingState=c.Gu.RESOLVE,!p&&e.isOtherArtistAlbumsAvailable?m=t.getOtherArtistAlbums({artistId:String(null===(I=b.artists[0])||void 0===I?void 0:I.id),limit:8},i):e.otherArtistAlbums.loadingState=c.Gu.RESOLVE,yield Promise.allSettled([a,m]),e.loadingState!==c.Gu.IDLE&&(e.loadingState=c.Gu.RESOLVE)}catch(t){m.error(t),t instanceof l.du&&(t.statusCode===l.CN.NOT_FOUND||t.statusCode===l.CN.BAD_REQUEST)&&(e.errorStatusCode=l.CN.NOT_FOUND),e.loadingState!==c.Gu.IDLE&&(e.loadingState=c.Gu.REJECT,e.otherArtistAlbums.loadingState=c.Gu.REJECT,e.latestGenreAlbums.loadingState=c.Gu.REJECT)}}),loadLastEpisodes(){t.getTracks({trackIds:e.lastEpisodesTrackIds})},reset(){let{sonataState:t}=(0,s.yj)(e);t.resetUnloadedEntitiesData(),e.meta=null,e.errorStatusCode=null,e.deprecationTargetAlbumId=null,e.items=(0,s.pj)([]),e.indexItems.clear(),e.trackIndexInContext.clear(),e.loadingState=c.Gu.IDLE,e.donations.loadingState=c.Gu.IDLE,e.donations.items=null,e.latestGenreAlbums.loadingState=c.Gu.IDLE,e.latestGenreAlbums.items=(0,s.pj)([]),e.otherArtistAlbums.loadingState=c.Gu.IDLE,e.otherArtistAlbums.items=(0,s.pj)([]),e.otherAlbumVersions=(0,s.pj)([]),e.description="",e.labels=null}};return t})},74488:function(e,t,a){"use strict";a.d(t,{AlbumNotFoundPage:function(){return r}});var i=a(9753),s=a(9544),l=a(98639),o=a(23948),n=a(63394);let r=(0,s.Pi)(()=>{let{album:e}=(0,n.oR)();return(0,l.useEffect)(()=>()=>{e.reset()},[e]),(0,i.jsx)(o.T,{})})},93289:function(e,t,a){"use strict";a.d(t,{AlbumPage:function(){return O}});var i,s,l=a(9753),o=a(9544),n=a(74717),r=a(98639),u=a(80542),d=a(70171),m=a(68106),c=a(93490),b=a(5293),v=a(20121),g=a(63394),A=a(67868),h=a(60836),p=a(31014),x=a(23881),E=a(84338),N=a(21585),f=a(2570),C=a(95772),I=a(10064),S=a(23472),G=a(38360),_=a(28417),k=a.n(_);let L=(0,o.Pi)(e=>{var t,a,i;let{albumHeaderRef:s,refCallback:o}=e,n=(0,r.useRef)(null),d=(0,g.x5)({pageId:g.Rh.ALBUM,blockId:g.aU.ALBUM}),m=(0,r.useRef)(0),{notify:b}=(0,g.d$)(),{album:v,experiments:_,sonataState:L}=(0,g.oR)(),{formatMessage:j}=(0,u.Z)(),[T,R]=(0,r.useState)(!1);(0,r.useEffect)(()=>()=>{m.current=0},[v]),(0,r.useEffect)(()=>{(v.otherArtistAlbums.loadingState===g.Gu.REJECT||v.latestGenreAlbums.loadingState===g.Gu.REJECT)&&m&&!(m.current>0)&&(b((0,l.jsx)(A.Q,{error:j({id:"album-errors.error-during-loading-similar-albums"})}),{containerId:g.W$.ERROR}),m.current++)},[v.isNotFound,v.latestGenreAlbums.loadingState,v.otherArtistAlbums.loadingState,j,b]),(0,r.useEffect)(()=>{v.isLoaded&&v.hasOtherAlbumVersions&&R(!0)},[v.hasOtherAlbumVersions,v.isLoaded]);let y=(0,r.useCallback)(()=>{let e=n.current;null==e||e.scrollIntoView({behavior:"smooth"})},[]),D=(0,r.useMemo)(()=>{if(_.checkExperiment(g.pe.WebNextAlbumDonateChooserButton,"on")&&v.donations.items&&v.donations.items.length){var e,t;return(0,l.jsx)(I.J,{shouldShowModal:Number(null===(t=v.meta)||void 0===t?void 0:null===(e=t.artists)||void 0===e?void 0:e.length)>1,donations:v.donations.items})}return null},[v.donations.items,null===(a=v.meta)||void 0===a?void 0:null===(t=a.artists)||void 0===t?void 0:t.length,_]),V=(0,r.useMemo)(()=>v.isLoading||!v.meta||v.isRejected?(0,l.jsx)(C.KC,{className:k().header,isActive:!0}):(0,l.jsx)(C.hx,{album:v.meta,actionButton:D,className:k().header,ref:s,onVersionClick:T?y:void 0}),[D,v.isLoading,v.isRejected,v.meta,s,y,T]),P=(0,r.useMemo)(()=>({Header:()=>V,Footer:()=>(0,l.jsxs)("div",{className:k().footerContainer,children:[(0,l.jsxs)("div",{className:k().carouselBlocks,children:[v.hasOtherAlbumVersions&&(0,l.jsx)(c.wk,{isShimmerVisible:v.isLoading,isShimmerActive:!0,className:k().carouselContainer,headerClassName:(0,h.W)(k().carouselBlock,k().carouselBlockHeader),containerClassName:k().carouselBlock,title:j({id:"entity-names.other-album-versions"}),albums:v.otherAlbumVersions,...(0,x.BA)(x.Br.album.OTHER_VERSIONS_CAROUSEL),headingRef:n}),v.hasLatestGenreAlbums&&(0,l.jsx)(c.wk,{isShimmerVisible:v.isLatestGenreAlbumsLoading,isShimmerActive:!0,className:k().carouselContainer,headerClassName:(0,h.W)(k().carouselBlock,k().carouselBlockHeader),containerClassName:k().carouselBlock,title:j({id:"entity-names.new-albums-in-genre"}),albums:v.latestGenreAlbums.items,...(0,x.BA)(x.Br.album.GENRE_ALBUMS_CAROUSEL)}),v.hasOtherArtistAlbums&&(0,l.jsx)(c.wk,{isShimmerVisible:v.isOtherArtistAlbumsLoading,isShimmerActive:!0,className:k().carouselContainer,headerClassName:(0,h.W)(k().carouselBlock,k().carouselBlockHeader),containerClassName:k().carouselBlock,title:j({id:"entity-names.other-albums-of-artist"}),albums:v.otherArtistAlbums.items,...(0,x.BA)(x.Br.album.OTHER_ARTIST_ALBUMS_CAROUSEL)})]}),(0,l.jsx)(A.$_,{className:k().footer})]})}),[V,v.hasOtherAlbumVersions,v.isLoading,v.otherAlbumVersions,v.hasLatestGenreAlbums,v.isLatestGenreAlbumsLoading,v.latestGenreAlbums.items,v.hasOtherArtistAlbums,v.isOtherArtistAlbumsLoading,v.otherArtistAlbums.items,j]),B=(0,r.useCallback)(e=>{let t=[];for(let a=e.startIndex;a<=e.endIndex;a++){let e=v.items[a];(null==e?void 0:e.type)===N.Vc.TRACK&&(null==e?void 0:e.loadingState)===g.Gu.IDLE&&t.push(e.id)}t.length&&v.getTracks({trackIds:t})},[v]),O=_.checkExperiment(g.pe.WebNextAlbumDisableTracks,"on")?0:v.items.length||10;return(0,l.jsx)(A.Wv,{className:(0,h.W)(k().root,k().important),listClassName:k().content,context:{listAriaLabel:j({id:"entity-names.albums-tracks-list"},{albumName:(null===(i=v.meta)||void 0===i?void 0:i.title)||""})},customComponents:P,totalCount:O,itemContentCallback:e=>{var t,a;let i=null==v?void 0:null===(t=v.items)||void 0===t?void 0:t[e];if(!i||!v.meta||v.isRejected)return(0,l.jsx)(A.DX,{isActive:!0,className:k().shimmerItem,variant:g.Lx.ALBUM});if(!(null==i?void 0:i.data))switch(null==i?void 0:i.type){case G.lf.TEXT:return(0,l.jsx)(A.AH,{className:k().shimmerItem});case N.Vc.TRACK:return(0,l.jsx)(A.DX,{isActive:!0,className:k().shimmerItem,variant:g.Lx.ALBUM})}return(null==i?void 0:i.type)===G.lf.TEXT?(0,l.jsx)("div",{className:(0,h.W)(k().shimmerItem,k().textItem),children:(0,l.jsx)(f.Caption,{variant:"span",type:"entity",size:"m",weight:"medium",className:k().text,children:(0,l.jsx)(p.Z,{id:"entity-names.disk-number",values:{number:i.data}})})}):i.data?(0,l.jsx)(S.RJ,{withLightning:i.isBest,track:i.data,position:i.position,albumArtists:null==v?void 0:null===(a=v.meta)||void 0===a?void 0:a.artists,playContextParams:{contextData:{type:E.Ak.Album,meta:v.contextMeta,from:d},queueParams:{index:v.trackIndexInContext.get(String(i.id))},loadContextMeta:!0,entitiesData:L.unloadedEntitiesDataFromModels}}):void 0},onGetDataByRange:B,debounceDurationInMs:300,initialItemCount:O,handleRef:o,withHeader:!0,testId:x.Br.album.ALBUM_PAGE})});var j=a(14102),T=a(38728);(i=s||(s={})).ABOUT="about",i.TRACKS="track-list";let R=[s.ABOUT,s.TRACKS],y=e=>{let{formatMessage:t}=(0,u.Z)(),a=Math.floor(e/60%60),i=Math.floor(e/60/60),s="";return i>0&&(s+=t({id:"time.hours"},{hours:i})),a>0&&(s+=(s.length>0?" ":"")+t({id:"time.minutes-left"},{minutes:a})),s};var D=a(55447),V=a.n(D);let P="activeTab",B=(0,o.Pi)(e=>{var t,a,i,o;let{nonMusicHeaderRef:n,refCallback:d}=e,m=(0,g.x5)({pageId:g.Rh.PODCAST,blockId:g.aU.PODCAST}),c=(0,r.useRef)(0),b=(0,r.useRef)(null),[v,x]=(0,r.useState)(s.ABOUT),I=(0,g.m5)(),{album:_,experiments:L,sonataState:D}=(0,g.oR)(),B=L.checkExperiment(g.pe.WebNextPodcastPage,"on"),O=(0,j.useTabsState)(0),{formatMessage:M}=(0,u.Z)();(0,r.useEffect)(()=>()=>{c.current=0},[_]),(0,r.useEffect)(()=>{var e,t,a;if(!B)return;(null===(e=window.location)||void 0===e?void 0:e.href)&&(b.current=new URL(window.location.href));let i=null===(t=b.current)||void 0===t?void 0:t.searchParams,l=null==i?void 0:i.get(P);R.includes(l)?(x(l),null===(a=O.onTabChange)||void 0===a||a.call(O,R.indexOf(l))):(null==i||i.set(P,s.ABOUT),I(String(b.current)))},[O,I,B]);let U=(0,r.useMemo)(()=>{var e;return(null===(e=_.meta)||void 0===e?void 0:e.isAudiobook)?{about:M({id:"non-music.audiobook-tab-about"}),"track-list":M({id:"non-music.audiobook-tab-tracks"})}:{about:M({id:"podcast.tab-about"}),"track-list":M({id:"podcast.tab-tracks"},{value:_.items.length})}},[null===(t=_.meta)||void 0===t?void 0:t.isAudiobook,_.items.length,M]),W=(0,r.useMemo)(()=>e=>{var t,a,i;if(!O.onTabChange||e===O.value)return;O.onTabChange(e);let l=null!==(i=R[e])&&void 0!==i?i:s.ABOUT;x(l),null===(a=b.current)||void 0===a||null===(t=a.searchParams)||void 0===t||t.set(P,l),I(String(b.current))},[O,I]),w=(e,t)=>(0,l.jsxs)("div",{className:V().infoBlock,children:[(0,l.jsx)(f.Caption,{variant:"span",type:"entity",size:"m",className:V().infoTitle,children:e}),(0,l.jsx)(f.Caption,{variant:"span",type:"entity",size:"m",children:t})]}),H=(0,r.useMemo)(()=>{var e,t,a,i,s,o,n,r,u,d,m,c,b,v,g,A,h;let p=Number(null===(e=_.labels)||void 0===e?void 0:e.length)>1?M({id:"podcast.publishers-title"}):M({id:"podcast.publisher-title"}),x=null===(t=_.labels)||void 0===t?void 0:t.map(e=>e.name).join(", "),E=M({id:"podcast.age-limit"}),N=Number(null===(i=_.meta)||void 0===i?void 0:null===(a=i.artists)||void 0===a?void 0:a.length)>1?M({id:"non-music.audiobook-artists"}):M({id:"non-music.audiobook-artist"}),C=null===(o=_.meta)||void 0===o?void 0:null===(s=o.artists)||void 0===s?void 0:s.map(e=>e.name).join(", "),I=(null===(r=_.meta)||void 0===r?void 0:null===(n=r.artists)||void 0===n?void 0:n.length)||(null===(u=_.meta)||void 0===u?void 0:u.durationSec)||(null===(d=_.labels)||void 0===d?void 0:d.length)||_.isExplicit,S=w("".concat(N,":"),String(C)),G=(null===(m=_.meta)||void 0===m?void 0:m.durationSec)&&w("".concat(M({id:"time.duration"}),":"),"".concat(y(null===(c=_.meta)||void 0===c?void 0:c.durationSec))),L=w("".concat(p,":"),String(x)),j=w("".concat(E,":"),"18+");return(0,l.jsxs)("div",{className:V().contentAbout,children:[!!(null===(b=_.description)||void 0===b?void 0:b.length)&&(0,l.jsx)(f.Caption,{variant:"div",type:"entity",size:"m",className:k().text,children:(0,l.jsx)("span",{dangerouslySetInnerHTML:{__html:_.description}})}),I&&(0,l.jsxs)("div",{className:k().text,children:[!!(null===(g=_.meta)||void 0===g?void 0:null===(v=g.artists)||void 0===v?void 0:v.length)&&S,(null===(A=_.meta)||void 0===A?void 0:A.durationSec)&&G,!!(null===(h=_.labels)||void 0===h?void 0:h.length)&&L,_.isExplicit&&j]})]})},[M,_.isExplicit,_.labels,_.description,null===(a=_.meta)||void 0===a?void 0:a.artists,null===(i=_.meta)||void 0===i?void 0:i.durationSec]),F=(0,r.useMemo)(()=>_.isLoading||!_.meta||_.isRejected?(0,l.jsx)(C.KC,{className:k().header,isActive:!0}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(C.HZ,{album:_.meta,className:k().header,ref:n}),B&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(A.no,{className:V().tabCarousel,...O,onTabChange:W,children:R.map((e,t)=>(0,l.jsx)(A.OK,{className:V().tab,title:U[e],value:t},e))}),v===s.ABOUT&&H]})]}),[_.isLoading,_.isRejected,_.meta,H,B,n,O,U,W,v]);(0,r.useEffect)(()=>{_.isLoaded&&_.loadLastEpisodes()},[_,_.isLoaded,_.loadLastEpisodes]);let J=L.checkExperiment(g.pe.WebNextPodcastPage,"on")&&v===s.ABOUT&&_.lastEpisodes.length>0,X=(0,r.useMemo)(()=>({Header:()=>F,Footer:()=>(0,l.jsxs)("div",{className:k().footerContainer,children:[J&&(0,l.jsx)(T.QG,{className:V().lastEpisodes}),(0,l.jsx)(A.$_,{className:k().footer})]})}),[F,J]),K=(0,r.useCallback)(e=>{let t=[];for(let a=e.startIndex;a<=e.endIndex;a++){let e=_.items[a];(null==e?void 0:e.type)===N.Vc.TRACK&&(null==e?void 0:e.loadingState)===g.Gu.IDLE&&t.push(e.id)}t.length&&_.getTracks({trackIds:t})},[_]),z=L.checkExperiment(g.pe.WebNextAlbumDisableTracks,"on")||B&&v===s.ABOUT?0:_.items.length||10,Z=(0,r.useMemo)(()=>{var e;return B&&v===s.TRACKS?{listAriaLabel:M({id:"podcast.episodes-list"},{albumName:(null===(e=_.meta)||void 0===e?void 0:e.title)||""})}:null},[v,null===(o=_.meta)||void 0===o?void 0:o.title,M,B]);return(0,l.jsx)(A.Wv,{className:(0,h.W)(k().root,k().important),listClassName:(0,h.W)(k().content,V().content),context:Z,customComponents:X,totalCount:z,itemContentCallback:e=>{var t;let a=null==_?void 0:null===(t=_.items)||void 0===t?void 0:t[e];if(!a||!_.meta||_.isRejected)return(0,l.jsx)(A.DX,{isActive:!0,className:k().shimmerItem,variant:g.Lx.ALBUM});if(!(null==a?void 0:a.data))switch(null==a?void 0:a.type){case G.lf.TEXT:return(0,l.jsx)(A.AH,{className:k().shimmerItem});case N.Vc.TRACK:return(0,l.jsx)(A.DX,{isActive:!0,className:k().shimmerItem,variant:g.Lx.ALBUM});default:return(0,l.jsx)(A.DX,{isActive:!0,className:V().shimmerItem,variant:g.Lx.PLAYLIST})}return(null==a?void 0:a.type)===G.lf.TEXT?(0,l.jsx)("div",{className:(0,h.W)(k().shimmerItem,k().textItem),children:(0,l.jsx)(f.Caption,{variant:"span",type:"entity",size:"m",className:k().text,children:(0,l.jsx)(p.Z,{id:"entity-names.season-number",values:{number:a.data}})})}):a.data?(0,l.jsx)(S.N6,{track:a.data,playContextParams:{contextData:{type:E.Ak.Album,meta:_.contextMeta,from:m},queueParams:{index:_.trackIndexInContext.get(String(a.id))},loadContextMeta:!1,entitiesData:D.unloadedEntitiesDataFromModels}}):void 0},onGetDataByRange:K,debounceDurationInMs:300,initialItemCount:z,handleRef:d,withHeader:!0})}),O=(0,o.Pi)(e=>{var t,a,i,s;let{albumId:o}=e,h=(0,r.useRef)(0),[p,x]=(0,b.zU)(),{notify:E}=(0,g.d$)(),{album:N,disclaimer:f}=(0,g.oR)(),{formatMessage:C}=(0,u.Z)(),{ref:I,offsetY:S}=(0,d.e)(),G=(0,r.useMemo)(()=>{var e;return(0,g.XG)(null===(e=N.meta)||void 0===e?void 0:e.averageColor)},[null===(t=N.meta)||void 0===t?void 0:t.averageColor]),[_,j]=(0,b.at)(G,S),{href:T}=(0,g.zB)("/album/".concat(N.deprecationTargetAlbumId)),R=(0,c.jV)({album:N.meta,shouldHistoryBack:!0}),y=(0,g.RV)();if((0,r.useEffect)(()=>{var e;(null===(e=N.meta)||void 0===e?void 0:e.isUnsafeLegal)&&R()},[null===(a=N.meta)||void 0===a?void 0:a.isUnsafeLegal,R]),(0,r.useEffect)(()=>()=>{N.reset()},[N,o]),o&&N.loadingState===g.Gu.IDLE){let e=Promise.allSettled([N.getData({albumId:Number(o),resumeStream:!1}),N.getDonations({albumId:Number(o)})]);(0,r.use)(e)}N.deprecationTargetAlbumId&&(0,n.redirect)(T),(0,r.useMemo)(()=>()=>{if(!N.isNotFound&&(N.isRejected||!N.meta&&!N.isLoading)){var e;if(!h||h.current>0)return;let t=(null===(e=N.meta)||void 0===e?void 0:e.isPodcast)?C({id:"podcast-errors.error-during-loading-podcast"}):C({id:"album-errors.error-during-loading-album"});E((0,l.jsx)(A.Q,{error:t}),{containerId:g.W$.ERROR}),h.current++}},[N.isRejected,N.isNotFound,N.meta,N.isLoading,E,C])(),(0,g.NO)(N.loadingState===g.Gu.RESOLVE),N.isNotFound&&(0,n.notFound)();let D=(0,r.useMemo)(()=>{var e;return(null===(e=N.meta)||void 0===e?void 0:e.isNonMusic)&&y?(0,l.jsx)(B,{nonMusicHeaderRef:I,refCallback:x}):(0,l.jsx)(L,{albumHeaderRef:I,refCallback:x})},[null===(i=N.meta)||void 0===i?void 0:i.isNonMusic,y,I,x]);return(null===(s=N.meta)||void 0===s?void 0:s.isLegalRejected)?f.isRejected?(0,l.jsx)(m.D,{}):(0,l.jsx)(v.em,{disclaimer:f}):(0,l.jsx)(g.Lh,{pageId:g.Rh.ALBUM,children:(0,l.jsxs)(b.I7,{scrollElement:p,children:[(0,l.jsx)(A.h4,{style:j}),(0,l.jsx)("div",{className:k().averageColorBackground,style:_}),D]})})})},38728:function(e,t,a){"use strict";a.d(t,{QG:function(){return i.LastEpisodes},JP:function(){return m}});var i=a(39064),s=a(42288),l=a(21585),o=a(23472),n=a(38360),r=a(63394);let u=s.V5.model("VolumeItemTrack",{type:s.V5.enumeration(Object.values(l.Vc)),id:s.V5.union(s.V5.string,s.V5.number),data:s.V5.maybeNull(o.le),position:s.V5.maybe(s.V5.number),isBest:s.V5.maybe(s.V5.boolean),loadingState:s.V5.enumeration(Object.values(r.Gu))}),d=s.V5.model("VolumeItemText",{type:s.V5.literal(n.lf.TEXT),data:s.V5.maybeNull(s.V5.number)}),m=s.V5.union(d,u)},39064:function(e,t,a){"use strict";a.d(t,{LastEpisodes:function(){return v}});var i=a(9753),s=a(60836),l=a(9544),o=a(98639),n=a(80542),r=a(84338),u=a(23472),d=a(63394),m=a(67868),c=a(631),b=a.n(c);let v=(0,l.Pi)(e=>{let{className:t}=e,{formatMessage:a}=(0,n.Z)(),{album:l,sonataState:c}=(0,d.oR)(),v=(0,d.x5)({pageId:d.Rh.PODCAST,blockId:d.aU.PODCAST}),g=(0,o.useMemo)(()=>l.lastEpisodes.map((e,t)=>l.isLoaded&&e.data?(0,i.jsx)(u.N6,{track:e.data,playContextParams:{contextData:{type:r.Ak.Album,meta:l.contextMeta,from:v},queueParams:{index:l.trackIndexInContext.get(String(e.id))},loadContextMeta:!1,entitiesData:c.unloadedEntitiesDataFromModels}},e.data.id):(0,i.jsx)(m.DX,{isActive:!0,className:b().shimmerItem,variant:d.Lx.ALBUM},t)),[l.lastEpisodes,l.isLoaded,l.contextMeta,l.trackIndexInContext,v,c.unloadedEntitiesDataFromModels]);return(0,i.jsxs)("div",{className:(0,s.W)(t,b().root),children:[(0,i.jsx)(m.ti,{className:b().blockHeader,title:a({id:"entity-names.podcast-last-episodes"})}),(0,i.jsx)("div",{role:"list","aria-label":a({id:"podcast.last-episodes-list"}),tabIndex:0,children:g})]})})},35131:function(e){e.exports={root:"DonationButton_root__SEKMn",popover:"DonationButton_popover__p_W9s"}},69590:function(e){e.exports={root:"DonationMenuItem_root__rsLgl",cover:"DonationMenuItem_cover__tzmM6",image:"DonationMenuItem_image__EgeO1"}},28417:function(e){e.exports={root:"AlbumPage_root__RMrFx",important:"AlbumPage_important__x2o8I",averageColorBackground:"AlbumPage_averageColorBackground__PmVaF",header:"AlbumPage_header__TDpqp",content:"AlbumPage_content__1JXxB",footerContainer:"AlbumPage_footerContainer__1IxWF",carouselBlocks:"AlbumPage_carouselBlocks__VIvNT",carouselBlock:"AlbumPage_carouselBlock__oWYmS",carouselBlockHeader:"AlbumPage_carouselBlockHeader__Bb3Ts",carouselContainer:"AlbumPage_carouselContainer__9clXz",textItem:"AlbumPage_textItem__1T3qL",text:"AlbumPage_text__rCU1L",shimmerItem:"AlbumPage_shimmerItem___Yecm",footer:"AlbumPage_footer__6_0Ei"}},55447:function(e){e.exports={tabCarousel:"NonMusicContent_tabCarousel__EBHWC",tab:"NonMusicContent_tab__LIh_U",contentAbout:"NonMusicContent_contentAbout__BMIP5",infoBlock:"NonMusicContent_infoBlock__IyjXA",infoTitle:"NonMusicContent_infoTitle__Wf9EC",content:"NonMusicContent_content__8Q0I8",lastEpisodes:"NonMusicContent_lastEpisodes__Xa8Xp"}},631:function(e){e.exports={root:"LastEpisodes_root__4JPKj",blockHeader:"LastEpisodes_blockHeader__se7bd",shimmerItem:"LastEpisodes_shimmerItem__Iirx5"}}}]);