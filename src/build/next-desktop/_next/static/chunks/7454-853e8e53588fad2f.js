(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7454],{46924:function(e,a,t){"use strict";t.r(a),t.d(a,{PlaylistNotFoundPage:function(){return r}});var i=t(8759),l=t(33423),s=t(2365);let r=(0,l.Pi)(()=>(0,i.jsx)(s.T,{}))},49773:function(e,a,t){"use strict";t.r(a),t.d(a,{PlaylistPage:function(){return U}});var i=t(8759),l=t(35338),s=t(33423),r=t(11769),n=t(99616),o=t(65244),d=t(27287),c=t(48157),m=t(79765),u=t(2814),g=t(9227),p=t(1918),v=t(20210),y=t(95539),h=t(3515),P=t(5674),_=t(44285),k=t(57413);let x=(e,a)=>{let t=e.id,i=e.albumId;return{contextData:{type:k.Ak.Various,meta:{id:i?"".concat(t,":").concat(i):t},from:a},queueParams:{index:0},loadContextMeta:!0}};var I=t(95431),S=t.n(I);let C=(0,s.Pi)(e=>{var a,t,s,r,d,c,k;let{autoFocus:I,onChange:C,className:L}=e,{formatMessage:f}=(0,o.Z)(),[T,D]=(0,n.useState)(""),{playlist:b}=(0,P.oR)(),N=null==b?void 0:b.searchItems,j=(0,y.Wc)(),A=(0,n.useRef)(0),E=(null===(a=b.meta)||void 0===a?void 0:a.isOwnPlaylist)?P.Rh.OWN_PLAYLISTS:P.Rh.PLAYLIST,B=(0,P.x5)({pageId:E,blockId:P.aU.FILTERED}),R=(0,P.x5)({pageId:E,blockId:P.aU.SUGGESTED}),[w,W]=(0,n.useState)(!1);(0,n.useEffect)(()=>()=>{window.clearTimeout(A.current),null==C||C(!1)},[C]);let M=(0,n.useMemo)(()=>(0,m.Z)(e=>{let a=e.trim();D(a),a&&(null==b?void 0:b.meta)&&(b.resetSearch(),b.getSearchTracks({uid:b.meta.uid,kind:b.meta.kind,part:a})),(!a||0===a.length)&&w&&(W(!1),b.refresh()),null==C||C(!!a.length)},100),[b,w,C]),O=(0,n.useCallback)(async e=>{if(b.meta){N.setAdditionTrackAnimation(e.id);let a=j({track:e,playlist:b.meta,withSuccessNotification:!1,withPageRefresh:!1}),t=new Promise(e=>{A.current=window.setTimeout(e,300)}),[i]=await Promise.all([a,t]);i===h.pX.OK?(N.replaceAdditionTrackInProggress(),W(!0)):N.resetAdditionTrackAnimation()}},[j,b.meta,N]),Y=(0,n.useMemo)(()=>{var e;return b.isSearchLoading?(0,i.jsx)(_.DX,{isActive:!0,className:S().shimmerItem,variant:P.Lx.PLAYLIST}):null==N?void 0:null===(e=N.playlistTracks)||void 0===e?void 0:e.map(e=>e?(0,i.jsx)(y.O2,{className:(0,l.W)(S().track,{[S().appearingTrack]:e.id===N.additionTrackInProggress}),track:e,playContextParams:x(e,B),shouldCheckSelfIndex:!1},e.id):null)},[b.isSearchLoading,null==N?void 0:N.playlistTracks,N.additionTrackInProggress,B]),F=(0,n.useMemo)(()=>{var e,a;return(null===(e=b.meta)||void 0===e?void 0:e.canUserChange)?b.isSearchLoading?(0,i.jsx)(_.DX,{isActive:!0,className:S().shimmerItem,variant:P.Lx.PLAYLIST}):null==N?void 0:null===(a=N.suggestedTracks)||void 0===a?void 0:a.map(e=>e?(0,i.jsx)(y.VZ,{track:e,className:(0,l.W)({[S().disappearingTrack]:e.id===N.additionTrackInProggress}),shouldCheckSelfIndex:!1,playContextParams:x(e,R),onClick:O},e.id):null):void 0},[null===(t=b.meta)||void 0===t?void 0:t.canUserChange,b.isSearchLoading,null==N?void 0:N.suggestedTracks,N.additionTrackInProggress,R,O]),K=(0,n.useMemo)(()=>{var e,a;return(null==N?void 0:null===(e=N.playlistTrackIds)||void 0===e?void 0:e.length)||(null==N?void 0:null===(a=N.suggestedTracks)||void 0===a?void 0:a.length)||b.isSearchLoading?null:(0,i.jsx)(v.vY,{className:S().emptyBlockContainer,isEmptySearch:!0})},[null==N?void 0:null===(s=N.playlistTrackIds)||void 0===s?void 0:s.length,null==N?void 0:null===(r=N.suggestedTracks)||void 0===r?void 0:r.length,b.isSearchLoading]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(g.M,{className:(0,l.W)(S().root,L),autoFocus:I,initialValue:T,correctedValue:null,placeholder:f({id:"search.track-placeholder"}),onChange:M,resetButtonAriaLabel:f({id:"interface-actions.reset-search-input"}),onResetClick:b.resetSearch}),T&&(0,i.jsxs)("div",{className:S().content,children:[K,Y,Number(null==N?void 0:null===(d=N.suggestedTracks)||void 0===d?void 0:d.length)>0&&(null===(c=b.meta)||void 0===c?void 0:c.canUserChange)&&(0,i.jsx)(p.Caption,{variant:"div",type:"text",size:"s",weight:"medium",className:(0,l.W)(S().catalog,{[S().catalog_withTracks]:null==N?void 0:null===(k=N.playlistTrackIds)||void 0===k?void 0:k.length}),children:(0,i.jsx)(u.Z,{id:"search.search-catalog"})},"search.search-catalog-caption"),F]})]})});var L=t(13236),f=t(90598),T=t.n(f),D=t(3786),b=t(63690),N=t.n(b);let j=(0,s.Pi)((0,n.forwardRef)((e,a)=>{var t;let{children:s,"data-index":r,...o}=e,{playlist:d}=(0,P.oR)(),{isDragging:c,listeners:m,setNodeRef:u,transform:g,transition:p,attributes:v}=(0,D.nB)({id:String(null===(t=d.items[r])||void 0===t?void 0:t.key)}),y=(0,n.useCallback)(e=>{u(e),"function"==typeof a&&a(e)},[a,u]),h={transition:p,"--translate-y":g?"".concat(Math.round(g.y),"px"):void 0};return(0,i.jsx)("div",{ref:y,"data-index":r,style:h,...o,className:N().root,children:(0,i.jsx)("div",{className:(0,l.W)(N().inner,{[N().dragging]:c}),...m,...v,children:s})})}));var A=t(2050),E=t(44757),B=t(98786);let R=(e,a)=>{var t;let i=a-1;if(!e.items.length||i<0||i>e.items.length)return"";let l=e.items[i];return(null==l?void 0:null===(t=l.data)||void 0===t?void 0:t.title)||""},w=e=>{let{formatMessage:a}=(0,o.Z)(),t={draggable:a({id:"drag-and-drop.playlist-move-instructions"})};return{screenReaderInstructions:t,announcements:{onDragStart(t){let{active:i}=t,l=R(e,Number(i.id)),s=i.id;return a({id:"drag-and-drop.playlist-on-move-start"},{trackName:l,index:s})},onDragOver(t){let{active:i,over:l}=t,s=R(e,Number(i.id));if(l){let e=l.id;return a({id:"drag-and-drop.playlist-on-move"},{trackName:s,index:e})}return a({id:"drag-and-drop.playlist-on-move-fail"},{trackName:s})},onDragEnd(t){let{active:i,over:l}=t,s=R(e,Number(i.id));if(l){let e=l.id;return a({id:"drag-and-drop.playlist-on-move-end-with-index"},{trackName:s,index:e})}return a({id:"drag-and-drop.playlist-on-move-end"},{trackName:s})},onDragCancel:()=>a({id:"drag-and-drop.playlist-on-move-cancel"})}}},W=e=>{let{notify:a}=(0,P.d$)(),{formatMessage:t}=(0,o.Z)();return(0,n.useCallback)(async l=>{var s,r,n,o;let{from:d,to:c}=l;if(d<0||c<0||d>=e.items.length||c>=e.items.length)return;let m=String(null===(s=e.items[d])||void 0===s?void 0:s.id);if(!m)return;let u=(null===(r=e.items[d])||void 0===r?void 0:r.albumId)?Number(null===(n=e.items[d])||void 0===n?void 0:n.albumId):void 0;e.moveTrack(d,c);let g=await (null===(o=e.meta)||void 0===o?void 0:o.changePlaylist((0,h.PG)({operation:h.aL.MOVE,startPosition:d,endPosition:c,tracks:[{id:m,albumId:u}]})));g&&g===h.pX.OK||(g===h.pX.RELOAD?e.refresh():e.moveTrack(c,d),a((0,i.jsx)(_.Q,{error:t({id:"drag-and-drop.failed-to-move"})}),{containerId:P.W$.ERROR}))},[t,a,e])};var M=t(81711),O=t.n(M);let Y=(0,s.Pi)(e=>{var a,t;let l,{index:s,className:r}=e,{playlist:n,experiments:o,sonataState:d}=(0,P.oR)(),c=o.checkExperiment(P.pe.WebNextPlaylistAddition,"on")&&(null===(a=n.meta)||void 0===a?void 0:a.isOwnPlaylist),m=(0,P.x5)({pageId:P.Rh.PLAYLIST,blockId:P.aU.PLAYLIST}),u=n.items[s];return n.isEmptyPlaylist&&c?(0,i.jsx)(v.vY,{className:O().emptyBlockContainer}):(l=u&&u.data&&n.meta?u.data.isTrackPodcast||(null===(t=u.data.mainAlbum)||void 0===t?void 0:t.isPodcast)?(0,i.jsx)(y.N6,{withPodcastName:!0,track:u.data,hasDuplicatesBefore:(0,h.BA)(n.items,u,s),playContextParams:{contextData:{type:k.Ak.Playlist,meta:n.contextMeta,from:m},entitiesData:d.unloadedEntitiesDataFromModels,queueParams:{index:s},loadContextMeta:!0},className:r}):(0,i.jsx)(y.O2,{track:u.data,hasDuplicatesBefore:(0,h.BA)(n.items,u,s),playContextParams:{contextData:{type:k.Ak.Playlist,meta:n.contextMeta,from:m},entitiesData:d.unloadedEntitiesDataFromModels,queueParams:{index:s},loadContextMeta:!0},className:r}):(0,i.jsx)(_.DX,{isActive:!0,className:O().shimmerItem,variant:P.Lx.PLAYLIST}),(0,i.jsx)(h.jK.Provider,{value:{playlist:n.meta,trackIndex:s},children:l}))});var F=t(43601),K=t.n(F);let V=(0,s.Pi)(e=>{let{children:a,playlist:t}=e,{announcements:l,screenReaderInstructions:s}=w(t),r=W(t),o=(0,A.Dy)((0,A.VT)(A.MA,{activationConstraint:{distance:{y:1},tolerance:5}}),(0,A.VT)(A.LO,{activationConstraint:{delay:250,tolerance:5}}),(0,A.VT)(A.Lg,{coordinateGetter:D.is,keyboardCodes:{start:["Enter"],cancel:["Escape"],end:["Enter"]}})),[d,c]=(0,n.useState)(null),m=(0,n.useCallback)(e=>{let{active:a}=e;c(a.id)},[]),u=(0,n.useCallback)(e=>{let{active:a,over:i}=e;if(!a.id||!(null==i?void 0:i.id))return;let l=t.itemsKeys.indexOf(String(a.id)),s=t.itemsKeys.indexOf(String(i.id));Number.isInteger(l)&&Number.isInteger(s)&&r({from:l,to:s})},[r,t.itemsKeys]),g=(0,n.useCallback)(()=>{c(null)},[]),p=(0,n.useMemo)(()=>t.itemsKeys.indexOf(String(d)),[d,t.itemsKeys]);return t.isDragAndDropEnabled?(0,i.jsxs)(A.LB,{sensors:o,collisionDetection:A.pE,onDragStart:m,onDragEnd:u,onDragCancel:g,modifiers:[E.DL,E.F4],accessibility:{announcements:l,screenReaderInstructions:s},children:[(0,i.jsx)("div",{className:K().root,children:(0,i.jsx)(D.Fo,{items:t.itemsKeys,strategy:D.qw,children:a})}),(0,B.createPortal)((0,i.jsx)(A.y9,{dropAnimation:{duration:0},children:d?(0,i.jsx)("div",{className:K().draggableItemWrapper,children:(0,i.jsx)(Y,{index:p,className:K().noHoverItem})}):null}),window.document.body)]}):a}),U=(0,s.Pi)(e=>{var a,t,s;let{userId:m,kind:u,playlistUuid:g}=e,p=(0,n.useRef)(0),{notify:y}=(0,P.d$)(),{playlist:h,experiments:k}=(0,P.oR)(),{formatMessage:x}=(0,o.Z)(),{ref:I,offsetY:S}=(0,d.e)(),[f,D]=(0,L.zU)(),b=(0,n.useMemo)(()=>{var e;return(0,P.XG)(null==h?void 0:null===(e=h.meta)||void 0===e?void 0:e.averageColor)},[null==h?void 0:null===(a=h.meta)||void 0===a?void 0:a.averageColor]),[N,A]=(0,L.at)(b,S),E=k.checkExperiment(P.pe.WebNextPlaylistAddition,"on")&&(null===(t=h.meta)||void 0===t?void 0:t.isOwnPlaylist),[B,R]=(0,n.useState)(!1),w=k.checkExperiment(P.pe.WebNextPlaylistAddition,"on");(0,n.useEffect)(()=>()=>{h.reset(),p.current=0},[h,g,m,u]);let W=(0,n.useMemo)(()=>()=>{(h.isRejected||!h.meta&&!h.isLoading)&&p&&!(p.current>0)&&(y((0,i.jsx)(_.Q,{error:x({id:"playlist-errors.error-during-loading-playlist"})}),{containerId:P.W$.ERROR}),p.current++)},[h.isRejected,h.meta,h.isLoading,y,x]);W(),h.loadingState===P.Gu.IDLE&&("string"==typeof g?(0,n.use)(h.getPlaylistByUuid({playlistUuid:g,resumeStream:!1})):"string"==typeof m&&"string"==typeof u&&(0,n.use)(h.getPlaylistByUserIdAndKind({userId:m,playlistKind:Number(u),resumeStream:!1}))),(0,P.NO)(h.loadingState===P.Gu.RESOLVE),h.isNotFound&&(0,r.notFound)();let M=(0,n.useMemo)(()=>h.isLoading||!h.meta||h.isRejected?(0,i.jsx)(c.KC,{className:T().header}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.Vm,{playlist:h.meta,isDisabled:h.isDisabled,className:T().header,ref:I}),w&&(0,i.jsx)(C,{autoFocus:!h.items.length,onChange:R})]}),[h.isDisabled,h.isLoading,h.meta,h.isRejected,I,h.items,w]),O=(0,n.useMemo)(()=>({Header:()=>M,Item:h.isDragAndDropEnabled?j:void 0,Footer:()=>(0,i.jsxs)("div",{className:T().footerContainer,children:[(0,i.jsx)("div",{className:T().carouselBlocks,children:h.hasSimilarPlaylists&&(0,i.jsx)(P.J,{blockId:P.BE.PLAYLISTS_SIMILAR_PLAYLIST,blockType:P.BE.PLAYLISTS_SIMILAR_PLAYLIST,blockPosX:1,blockPosY:2,blockIdForFrom:P.BE.PLAYLISTS_SIMILAR_PLAYLIST,objectsCount:h.similarPlaylists.length,children:(0,i.jsx)(v.VD,{isShimmerVisible:h.isLoading,isShimmerActive:!0,className:T().carouselContainer,headerClassName:(0,l.W)(T().carouselBlockHeader,T().carouselBlock),containerClassName:T().carouselBlock,title:x({id:"entity-names.similar-playlists"}),playlists:h.similarPlaylists})})}),!(h.isEmptyPlaylist&&E)&&(0,i.jsx)(_.$_,{className:T().footer})]})}),[h.isDragAndDropEnabled,h.hasSimilarPlaylists,h.similarPlaylists,h.isLoading,h.isEmptyPlaylist,M,x,E]),F=(0,n.useCallback)(e=>{h.getTracksByRange(e)},[h]),K=(0,n.useCallback)(e=>{var a;return null===(a=h.items[e])||void 0===a?void 0:a.key},[h.items]),U=(0,n.useCallback)(e=>e,[]),X=h.items.length||(E?1:0);return(0,i.jsx)(P.Lh,{pageId:P.Rh.PLAYLIST,children:(0,i.jsxs)(L.I7,{scrollElement:f,children:[(0,i.jsx)(_.h4,{style:A}),(0,i.jsx)("div",{className:T().averageColorBackground,style:N}),(0,i.jsx)(V,{playlist:h,children:(0,i.jsx)(_.Wv,{context:{listAriaLabel:x({id:"entity-names.playlist-tracks-list"},{playlistName:(null===(s=h.meta)||void 0===s?void 0:s.title)||""})},className:(0,l.W)(T().root,T().important),listClassName:T().content,customComponents:O,computeItemKey:h.isDragAndDropEnabled?K:U,totalCount:B?0:X,itemContentCallback:e=>(0,i.jsx)(Y,{index:e}),onGetDataByRange:F,debounceDurationInMs:300,initialItemCount:h.items.length,handleRef:D,shouldTriggerRangeChangedOnTotalCountChange:!0})})]})})})},90598:function(e){e.exports={root:"PlaylistPage_root__ajyaP",important:"PlaylistPage_important__1Xpl5",averageColorBackground:"PlaylistPage_averageColorBackground__3wEkw",header:"PlaylistPage_header__EdIoE",content:"PlaylistPage_content__T7zOm",footerContainer:"PlaylistPage_footerContainer__8uPBx",carouselBlock:"PlaylistPage_carouselBlock__lvaKg",carouselBlockHeader:"PlaylistPage_carouselBlockHeader__asTWy",carouselContainer:"PlaylistPage_carouselContainer__TfWiI",footer:"PlaylistPage_footer__ih_cJ"}},63690:function(e){e.exports={root:"PlaylistPageDnDItemWrapper_root__eBm1E",inner:"PlaylistPageDnDItemWrapper_inner__UXQZf",dragging:"PlaylistPageDnDItemWrapper_dragging__Pl94m",dragOverlay:"PlaylistPageDnDItemWrapper_dragOverlay__tWQut"}},43601:function(e){e.exports={root:"PlaylistPageDnDList_root__6Fryw",draggableItemWrapper:"PlaylistPageDnDList_draggableItemWrapper__vvEWL",noHoverItem:"PlaylistPageDnDList_noHoverItem__dbPTH"}},81711:function(e){e.exports={emptyBlockContainer:"PlaylistPageItem_emptyBlockContainer__K5xRV",shimmerItem:"PlaylistPageItem_shimmerItem__s_fFo"}},95431:function(e){e.exports={root:"SearchPlaylistInput_root__o14iM",content:"SearchPlaylistInput_content__iDyfU",catalog:"SearchPlaylistInput_catalog__5r6Xm",catalog_withTracks:"SearchPlaylistInput_catalog_withTracks__B2ZYF",track:"SearchPlaylistInput_track__2TGLS",shimmerItem:"SearchPlaylistInput_shimmerItem__V0cOt",emptyBlockContainer:"SearchPlaylistInput_emptyBlockContainer__NSQKG",disappearingTrack:"SearchPlaylistInput_disappearingTrack__D6ja5",disappearing:"SearchPlaylistInput_disappearing__w48Cd",appearingTrack:"SearchPlaylistInput_appearingTrack__CYHzN",appearing:"SearchPlaylistInput_appearing__SafaE"}}}]);