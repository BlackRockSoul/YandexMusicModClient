(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2905],{12905:function(e,t,a){"use strict";a.r(t),a.d(t,{MusicHistoryPage:function(){return I}});var i=a(8759),n=a(35338),r=a(33423),o=a(11769),s=a(99616),l=a(2814),c=a(71716),d=a(26265),u=a(1918),m=a(67414),v=a(70579),x=a(42769),p=a(84133),h=a(44285),y=a(66936);let _=e=>{let{children:t}=e,a=(0,s.useRef)({}),n=(0,s.useMemo)(()=>(0,y.wE)(e=>{var t,i;let n=(0,y.SG)(e.target),r=a.current[n];e.isIntersecting?null==r||null===(t=r.onShow)||void 0===t||t.call(r):null==r||null===(i=r.onHide)||void 0===i||i.call(r)}),[]);(0,s.useEffect)(()=>()=>null==n?void 0:n.disconnect(),[n]);let r=(0,s.useCallback)(e=>{!a.current[e.elementId]&&e.elementRef.current&&(null==n||n.observe(e.elementRef.current),a.current[e.elementId]=e)},[n]),o=(0,s.useCallback)(e=>{let t=a.current[e];t&&t.elementRef.current&&(null==n||n.unobserve(t.elementRef.current))},[n]),l=(0,s.useMemo)(()=>({observeElement:r,unobserveElement:o}),[r,o]);return(0,i.jsx)(m.ee.Provider,{value:l,children:t})},g=async(e,t)=>new Promise(a=>{if("onscrollend"in window){var i;let n=()=>{var e;a(),null===(e=t.current)||void 0===e||e.removeEventListener("scrollend",n)};null===(i=t.current)||void 0===i||i.addEventListener("scrollend",n),e.scrollIntoView({behavior:"smooth"})}else e.scrollIntoView({behavior:"smooth"}),window.setTimeout(a,1e3)});var k=a(36518),b=a.n(k),f=a(12670),j=a(76098),S=a.n(j);let C=()=>{let e=(0,i.jsxs)("div",{className:S().trackListShimmers,children:[(0,i.jsx)(h.DX,{variant:p.Lx.PLAYLIST}),(0,i.jsx)(h.DX,{variant:p.Lx.PLAYLIST}),(0,i.jsx)(h.DX,{variant:p.Lx.PLAYLIST})]});return(0,i.jsxs)("div",{className:S().shimmersContainer,children:[(0,i.jsx)(f.Shimmer,{className:S().dateShimmer}),(0,i.jsx)(f.Shimmer,{className:S().contextNameShimmer}),(0,i.jsx)(h.XM,{withDescription:!0,className:S().contextHeaderShimmer}),e,(0,i.jsx)(f.Shimmer,{className:S().contextNameShimmer}),(0,i.jsx)(h.XM,{coverRadius:"round",className:S().contextHeaderShimmer}),e]})},I=(0,r.Pi)(()=>{let{musicHistory:e,experiments:t}=(0,p.oR)(),a=(0,d.useTabsState)(0),r=(0,s.useRef)(!1),y=(0,s.useRef)(null),k=(0,s.useCallback)(async t=>{var i;let n=e.dates[t];if(!n)return;null===(i=a.onTabChange)||void 0===i||i.call(a,t),r.current=!0;let o=document.querySelector('[data-date-anchor="'.concat(n,'"]'));o&&await g(o,y),r.current=!1},[e.dates,a]);t.checkExperiment(p.pe.WebNextMusicHistory,"on")||(0,o.notFound)(),e.loadingState===p.Gu.IDLE&&(0,s.use)(e.getMusicHistory());let f=(0,s.useCallback)(()=>{if(r.current)return;let t=e.dates.findIndex(t=>e.datesMap.get(t));if(t>=0){var i;null===(i=a.onTabChange)||void 0===i||i.call(a,t)}},[e.dates,e.datesMap,a]);(0,s.useEffect)(()=>()=>e.reset(),[e]),(0,p.NO)(e.loadingState===p.Gu.RESOLVE);let j=(0,s.useMemo)(()=>{var t;return e.isRejected?(0,i.jsx)(v.D,{className:(0,n.W)(b().error,b().important),withBackwardControl:!1}):e.isLoading?(0,i.jsx)(C,{}):e.isEmpty?(0,i.jsx)("div",{className:b().empty,children:(0,i.jsx)(u.Caption,{variant:"div",size:"m",weight:"normal",children:(0,i.jsx)(l.Z,{id:"music-history.empty-title"})})}):null===(t=e.tabs)||void 0===t?void 0:t.map((e,t)=>(0,i.jsx)(m.Wb,{onTabShowOrHide:f,"data-intersection-property-id":e.date,tab:e,tabIndex:t},t))},[f,e.isEmpty,e.isLoading,e.isRejected,e.tabs]),S=(0,m.e8)();return(0,i.jsx)(p.Lh,{pageId:p.Rh.HISTORY,children:(0,i.jsxs)("div",{className:b().root,children:[(0,i.jsxs)("div",{className:b().headerContainer,children:[(0,i.jsxs)("div",{className:b().header,children:[(0,i.jsx)(x.n,{withForwardControl:!1}),(0,i.jsx)(u.Heading,{variant:"h1",weight:"bold",size:"xl",lineClamp:1,children:(0,i.jsx)(l.Z,{id:"music-history.title"})})]}),(0,i.jsx)(h.no,{isLoading:e.isLoading,className:b().tabs,...a,onTabChange:k,shimmer:(0,i.jsx)(h.tS,{className:b().tabs,shimmerClassName:(0,n.W)(b().tab,{[b().tab_isLoading]:e.isLoading}),count:5}),children:e.dates.map((e,t)=>(0,i.jsx)(h.OK,{className:(0,n.W)(b().tab,{[b().tab_selected]:t===a.value}),titleClassName:b().date,"aria-label":S(e,!1),title:S(e,!1),value:t},t))})]}),(0,i.jsxs)(c.t,{ref:y,className:b().scroll,containerClassName:b().scrollContainer,children:[(0,i.jsx)(_,{children:(0,i.jsx)("div",{className:b().content,children:j})}),(0,i.jsx)(h.$_,{className:b().footer})]})]})})})},67414:function(e,t,a){"use strict";a.d(t,{ee:function(){return P.MusicHistoryIntersectionObserverContext},Wb:function(){return A.MusicHistoryTab},t9:function(){return b},un:function(){return f},H5:function(){return I},aQ:function(){return L},LV:function(){return j},R3:function(){return w},Ql:function(){return T},DF:function(){return O},v3:function(){return R},eE:function(){return D},OE:function(){return V},e8:function(){return G.useFormatDate}});var i=a(96555),n=a(36019),r=a(96911),o=a(84133),s=a(86502);let l=e=>({type:s.RX.Unloaded,meta:{id:e.entityId}});var c=a(95539);let d=i.V5.model("MusicHistoryTrack",{type:i.V5.literal(n.EW.TRACK),id:i.V5.string,data:i.V5.maybeNull(c.le),loadingState:i.V5.enumeration(Object.values(o.Gu))}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get entityId(){var t;if(!e.data)return e.id;let{id:a,albums:i}=e.data,n=null===(t=i[0])||void 0===t?void 0:t.id;return n?"".concat(a,":").concat(n):a}})).named("MusicHistoryPlaylist"),u=i.V5.model("MusicHistoryBaseBlock",{id:i.V5.string,loadingState:i.V5.enumeration(Object.values(o.Gu)),tracks:i.V5.array(d)}).views(e=>({get isLoaded(){return e.loadingState===o.Gu.RESOLVE},get contextId(){return e.id},get entitiesData(){return e.tracks.map(l)}})),m=u.props({type:i.V5.literal(n.EW.ALBUM),available:i.V5.boolean,meta:i.V5.maybeNull(r.ug)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get autoflowSeeds(){var t;return["album:".concat(null===(t=e.meta)||void 0===t?void 0:t.id)]}})).named("MusicHistoryAlbum");var v=a(81446);let x=u.props({type:i.V5.literal(n.EW.ARTIST),available:i.V5.boolean,meta:i.V5.maybeNull(v.Go)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get autoflowSeeds(){var t;return["artist:".concat(null===(t=e.meta)||void 0===t?void 0:t.id)]}})).named("MusicHistoryArtist"),p=i.V5.model("MusicHistoryCommon",{id:i.V5.string,type:i.V5.union(i.V5.literal(n.EW.OTHER),i.V5.literal(n.EW.SEARCH)),tracks:i.V5.array(d)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get contextId(){return e.tracks.map(e=>e.id).join(",")},get entitiesData(){return e.tracks.map(l)}}));var h=a(20210);let y=u.props({type:i.V5.literal(n.EW.PLAYLIST),meta:i.V5.maybeNull(h.d2)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get autoflowSeeds(){var t,a;return["playlist:".concat(null===(t=e.meta)||void 0===t?void 0:t.uid,"_").concat(null===(a=e.meta)||void 0===a?void 0:a.kind)]}})).named("MusicHistoryPlaylist");var _=a(84290);let g=u.props({id:i.V5.string,type:i.V5.literal(n.EW.WAVE),meta:i.V5.maybeNull(_.KW)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get contextId(){var t,a;return null!==(a=null===(t=e.meta)||void 0===t?void 0:t.stationId)&&void 0!==a?a:o.sH},get autoflowSeeds(){var i;return null===(i=e.meta)||void 0===i?void 0:i.seeds}})),k=i.V5.union(m,x,y,g,p),b=i.V5.model("MusicHistoryTab",{date:i.V5.string,blocks:i.V5.maybeNull(i.V5.array(k))}),f=e=>e.data.itemId.id,j=e=>{let{albumId:t,trackId:a}=e.data.itemId;return t?"".concat(a,":").concat(t):a},S=e=>{if("fullModel"in e.data){let{fullModel:t}=e.data;return(0,i.pj)({type:n.EW.TRACK,id:j(e),loadingState:o.Gu.RESOLVE,data:(0,c.Vt)(t)})}return(0,i.pj)({type:n.EW.TRACK,id:j(e),data:null,loadingState:o.Gu.IDLE})},C=(e,t)=>{let{data:a}=e;if("fullModel"in a){let{fullModel:s}=a;return(0,i.pj)({type:n.EW.ALBUM,available:s.available,id:f(e),meta:(0,r.cO)({album:s.album,artists:s.artists}),loadingState:o.Gu.RESOLVE,tracks:t.map(S)})}return(0,i.pj)({type:n.EW.ALBUM,available:!0,id:f(e),meta:null,loadingState:o.Gu.IDLE,tracks:t.map(S)})},I=e=>e.data.itemId.id,M=(e,t)=>{let{data:a,type:n}=e;if("fullModel"in a){let{fullModel:r}=a;return(0,i.pj)({type:n,available:r.available,id:I(e),meta:(0,v.tR)(r.artist),loadingState:o.Gu.RESOLVE,tracks:t.map(S)})}return(0,i.pj)({type:n,available:!0,id:I(e),meta:null,loadingState:o.Gu.IDLE,tracks:t.map(S)})};var E=a(42503);let W=(e,t)=>{let{type:a}=e;return(0,i.pj)({type:a,id:(0,E.Z)(),tracks:t.map(S)})},L=e=>{let{uid:t,kind:a}=e.data.itemId;return"".concat(t,":").concat(a)},N=(e,t)=>{let{data:a,type:r}=e;if("fullModel"in a){let{fullModel:n}=a;return(0,i.pj)({type:r,id:L(e),meta:{...(0,h.RE)({playlist:n.playlist}),tracksCount:n.tracksCount},loadingState:o.Gu.RESOLVE,tracks:t.map(S)})}return(0,i.pj)({type:n.EW.PLAYLIST,id:L(e),meta:null,loadingState:o.Gu.IDLE,tracks:t.map(S)})},w=e=>e.data.itemId.seeds.sort().join(","),H=(e,t)=>{let{data:a,type:n}=e;if("fullModel"in a){let{fullModel:r}=a;return(0,i.pj)({type:n,id:w(e),meta:{...(0,_.FF)(r.wave),imageUrl:r.simpleWaveForegroundImageUrl,backgroundColor:r.simpleWaveBackgroundColor},loadingState:o.Gu.RESOLVE,tracks:t.map(S)})}return(0,i.pj)({type:n,id:w(e),meta:null,loadingState:o.Gu.IDLE,tracks:t.map(S)})},V=e=>{var t,a;let r=null===(t=e.items)||void 0===t?void 0:t.map(e=>{switch(e.context.type){case n.EW.ALBUM:return C(e.context,e.tracks);case n.EW.PLAYLIST:return N(e.context,e.tracks);case n.EW.ARTIST:return M(e.context,e.tracks);case n.EW.WAVE:return H(e.context,e.tracks);case n.EW.SEARCH:case n.EW.OTHER:return W(e.context,e.tracks);default:return null}}).filter(e=>e);return{date:e.date,blocks:null!==(a=(0,i.pj)(r))&&void 0!==a?a:null}};var A=a(8200),P=a(60528);a(53783);let R=e=>(null==e?void 0:e.type)===n.EW.PLAYLIST,T=e=>(null==e?void 0:e.type)===n.EW.ALBUM,D=e=>(null==e?void 0:e.type)===n.EW.WAVE,O=e=>(null==e?void 0:e.type)===n.EW.ARTIST;var G=a(69663)},60528:function(e,t,a){"use strict";a.r(t),a.d(t,{MusicHistoryIntersectionObserverContext:function(){return n}});var i=a(99616);let n=(0,i.createContext)({observeElement:()=>{},unobserveElement:()=>{}})},69663:function(e,t,a){"use strict";a.r(t),a.d(t,{useFormatDate:function(){return r}});var i=a(99616),n=a(65244);let r=()=>{let{formatDate:e,formatRelativeTime:t}=(0,n.Z)();return(0,i.useCallback)(function(a){let i=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=new Date(a),r=new Date;n.setHours(0,0,0,0),r.setHours(0,0,0,0);let o=n.getTime()-r.getTime(),s=o/864e5,l=t(s,"day",{numeric:"auto"}),c=e(a,{day:"numeric",month:"long"});switch(s){case 0:case -1:case -2:if(i)return"".concat(l,", ").concat(c);return l;default:return c}},[e,t])}},53783:function(e,t,a){"use strict";a.d(t,{M:function(){return o}});var i=a(96555),n=a(36019),r=a(84133);let o=i.V5.model({id:i.V5.string,type:i.V5.enumeration(Object.values(n.EW)),tabIndex:i.V5.number,blockIndex:i.V5.number,trackIndex:i.V5.maybeNull(i.V5.number),loadingState:i.V5.enumeration(Object.values(r.Gu))}).views(e=>({get isLoaded(){return e.loadingState===r.Gu.RESOLVE}}))},8200:function(e,t,a){"use strict";a.r(t),a.d(t,{MusicHistoryTab:function(){return N}});var i=a(8759),n=a(33423),r=a(99616),o=a(36019),s=a(1918),l=a(84133),c=a(60528),d=a(69663),u=a(35338),m=a(2814),v=a(71440),x=a(81446),p=a(44285);let h=e=>{let{id:t,tabIndex:a,blockIndex:i,trackIndex:n}=e,{musicHistory:o}=(0,l.oR)(),s=(0,r.useId)(),d=(0,r.useRef)(null),{observeElement:u,unobserveElement:m}=(0,r.useContext)(c.MusicHistoryIntersectionObserverContext);return(0,r.useEffect)(()=>{let e=void 0!==n?"".concat(a,"_").concat(i,"_").concat(n,"_").concat(t):"".concat(a,"_").concat(i,"_").concat(t),r=o.indexesMap.get(e);o.isInObservationRange(r)&&u({elementRef:d,elementId:s,index:r,onShow(){o.getItems(this.index),m(s)}})},[i,t,s,o,u,a,n,m]),{intersectionPropertyId:s,ref:d}};var y=a(95539),_=a(66710),g=a.n(_);let k=(0,n.Pi)(e=>{let{type:t,track:a,artists:n,tabIndex:r,blockIndex:o,trackIndex:s,playContextParams:c}=e,{ref:d,intersectionPropertyId:u}=h({id:a.id,tabIndex:r,blockIndex:o,trackIndex:s});return a.data?t===v.Ak.Album?(0,i.jsx)(y.RJ,{track:a.data,position:a.data.index,albumArtists:n,playContextParams:c}):(0,i.jsx)(y.O2,{track:a.data,playContextParams:c}):(0,i.jsx)("div",{"data-intersection-property-id":u,ref:d,children:(0,i.jsx)(p.DX,{"data-intersection-property-id":u,className:g().trackShimmer,variant:t===v.Ak.Album?l.Lx.ALBUM:l.Lx.PLAYLIST})})});var b=a(65019),f=a.n(b);let j=(0,n.Pi)(e=>{var t,a,n,o;let{album:c,tabIndex:d,blockIndex:y}=e,{ref:_,intersectionPropertyId:g}=h({id:c.id,tabIndex:d,blockIndex:y}),b=(0,l.x5)({blockId:"album-".concat(c.id)}),j=(0,r.useMemo)(()=>{var e,t;return c.available?(0,i.jsx)(x.jO,{className:f().artists,linkClassName:f().artistLink,artists:null===(e=c.meta)||void 0===e?void 0:e.artists,lineClamp:1}):null===(t=c.meta)||void 0===t?void 0:t.artistNames},[c.available,null===(t=c.meta)||void 0===t?void 0:t.artistNames,null===(a=c.meta)||void 0===a?void 0:a.artists]),S=(0,r.useMemo)(()=>{var e,t;return c.isLoaded?(0,i.jsx)(p.ti,{className:f().header,coverUrl:null===(e=c.meta)||void 0===e?void 0:e.coverUri,title:null===(t=c.meta)||void 0===t?void 0:t.title,titleSize:"xs",titleLineClamp:1,description:j,titleClassName:f().headerTitle,viewAllActionLink:"/album/".concat(c.id),available:c.available,fallbackIconVariant:"album",withCoverFallback:!0}):(0,i.jsx)(p.XM,{className:f().header,withDescription:!0})},[c.available,c.id,c.isLoaded,null===(n=c.meta)||void 0===n?void 0:n.coverUri,null===(o=c.meta)||void 0===o?void 0:o.title,j]),C=(0,r.useMemo)(()=>c.tracks.map((e,t)=>{let a={contextData:{type:v.Ak.Various,meta:{id:c.contextId},from:b,overrideContextType:v.Zc.Album,overrideAutoflowSeeds:c.autoflowSeeds},queueParams:{index:t},loadContextMeta:!1,entitiesData:c.entitiesData};return(0,i.jsx)(k,{type:v.Ak.Album,track:e,playContextParams:a,tabIndex:d,blockIndex:y,trackIndex:t},"".concat(e.key,"_").concat(t))}),[c.tracks,c.contextId,c.autoflowSeeds,c.entitiesData,b,d,y]);return(0,i.jsxs)("section",{className:f().root,ref:_,"data-intersection-property-id":g,children:[(0,i.jsx)(s.Caption,{className:(0,u.W)(f().header,f().heading),type:"text",size:"s",weight:"medium",variant:"div",children:(0,i.jsx)(m.Z,{id:"music-history.album"})}),S,(0,i.jsx)("div",{className:f().content,children:C})]})}),S=(0,n.Pi)(e=>{var t,a;let{artist:n,tabIndex:o,blockIndex:c}=e,{ref:d,intersectionPropertyId:x}=h({id:n.id,tabIndex:o,blockIndex:c}),y=(0,l.x5)({blockId:"artist-".concat(n.id)}),_=(0,r.useMemo)(()=>{var e,t;return n.isLoaded?(0,i.jsx)(p.ti,{titleSize:"xs",titleLineClamp:1,className:f().header,coverUrl:null===(e=n.meta)||void 0===e?void 0:e.coverUri,title:null===(t=n.meta)||void 0===t?void 0:t.name,titleClassName:f().headerTitle,viewAllActionLink:"/artist/".concat(n.id),available:n.available,withCoverFallback:!0,coverRadius:"round"}):(0,i.jsx)(p.XM,{className:f().header,coverRadius:"round"})},[n.available,n.id,n.isLoaded,null===(t=n.meta)||void 0===t?void 0:t.coverUri,null===(a=n.meta)||void 0===a?void 0:a.name]),g=(0,r.useMemo)(()=>n.tracks.map((e,t)=>{let a={contextData:{type:v.Ak.Various,meta:{id:n.contextId},from:y,overrideAutoflowSeeds:n.autoflowSeeds,overrideContextType:v.Zc.Artist},queueParams:{index:t},loadContextMeta:!1,entitiesData:n.entitiesData};return(0,i.jsx)(k,{type:v.Ak.Artist,track:e,playContextParams:a,tabIndex:o,blockIndex:c,trackIndex:t},"".concat(e.id,"_").concat(t))}),[n.tracks,n.contextId,n.autoflowSeeds,n.entitiesData,y,o,c]);return(0,i.jsxs)("section",{className:f().root,ref:d,"data-intersection-property-id":x,children:[(0,i.jsx)(s.Caption,{className:(0,u.W)(f().header,f().heading),type:"text",size:"s",weight:"medium",variant:"div",children:(0,i.jsx)(m.Z,{id:"music-history.artist"})}),_,(0,i.jsx)("div",{className:f().content,children:g})]})}),C=(0,n.Pi)(e=>{let{common:t,tabIndex:a,blockIndex:n}=e,{ref:c,intersectionPropertyId:d}=h({id:t.id,tabIndex:a,blockIndex:n}),x=(0,l.x5)(),p=(0,r.useMemo)(()=>t.tracks.map((e,r)=>{let s={contextData:{type:v.Ak.Various,meta:{id:t.contextId},overrideContextType:t.type===o.EW.SEARCH?v.Zc.Search:v.Zc.Other,from:x},queueParams:{index:r},loadContextMeta:!1,entitiesData:t.entitiesData};return(0,i.jsx)(k,{playContextParams:s,type:v.Ak.Various,track:e,tabIndex:a,blockIndex:n,trackIndex:r},"".concat(e.id,"_").concat(r))}),[t.tracks,t.contextId,t.type,t.entitiesData,x,a,n]),y=(0,r.useMemo)(()=>{switch(t.type){case o.EW.OTHER:return(0,i.jsx)(m.Z,{id:"music-history.shuffle"});case o.EW.SEARCH:return(0,i.jsx)(m.Z,{id:"music-history.search"})}},[t.type]);return(0,i.jsxs)("section",{className:f().root,ref:c,"data-intersection-property-id":d,children:[(0,i.jsx)(s.Caption,{className:(0,u.W)(f().header,f().heading),type:"text",size:"s",weight:"medium",variant:"div",children:y}),(0,i.jsx)("div",{className:f().content,children:p})]})});var I=a(65244);let M=(0,n.Pi)(e=>{var t,a,n,o,c;let{playlist:d,tabIndex:x,blockIndex:y}=e,{ref:_,intersectionPropertyId:g}=h({id:d.id,tabIndex:x,blockIndex:y}),b=(0,l.x5)({blockId:d.isLoaded?"playlist-".concat(null===(t=d.meta)||void 0===t?void 0:t.id):""}),{formatMessage:j}=(0,I.Z)(),S=(0,r.useMemo)(()=>{var e,t,a,n;return d.isLoaded?(0,i.jsx)(p.ti,{className:f().header,titleSize:"xs",titleLineClamp:1,coverUrl:null===(e=d.meta)||void 0===e?void 0:e.coverUri,title:null===(t=d.meta)||void 0===t?void 0:t.title,titleClassName:f().headerTitle,description:j({id:"entity-names.number-of-tracks"},{counter:null===(a=d.meta)||void 0===a?void 0:a.tracksCount}),fallbackIconVariant:"playlist",withCoverFallback:!0,viewAllActionLink:"/playlist/".concat(null===(n=d.meta)||void 0===n?void 0:n.uuid)}):(0,i.jsx)(p.XM,{className:f().header,withDescription:!0})},[j,d.isLoaded,null===(a=d.meta)||void 0===a?void 0:a.coverUri,null===(n=d.meta)||void 0===n?void 0:n.title,null===(o=d.meta)||void 0===o?void 0:o.tracksCount,null===(c=d.meta)||void 0===c?void 0:c.uuid]),C=(0,r.useMemo)(()=>d.tracks.map((e,t)=>{let a={contextData:{type:v.Ak.Various,meta:{id:d.contextId},from:b,overrideAutoflowSeeds:d.autoflowSeeds,overrideContextType:v.Zc.Playlist},queueParams:{index:t},loadContextMeta:!1,entitiesData:d.entitiesData};return(0,i.jsx)(k,{playContextParams:a,type:v.Ak.Playlist,track:e,tabIndex:x,blockIndex:y,trackIndex:t},"".concat(e.id,"_").concat(t))}),[d.tracks,d.contextId,d.autoflowSeeds,d.entitiesData,b,x,y]);return(0,i.jsxs)("section",{className:f().root,ref:_,"data-intersection-property-id":g,children:[(0,i.jsx)(s.Caption,{className:(0,u.W)(f().header,f().heading),type:"text",size:"s",weight:"medium",variant:"div",children:(0,i.jsx)(m.Z,{id:"music-history.playlist"})}),S,(0,i.jsx)("div",{className:f().content,children:C})]})}),E=(0,n.Pi)(e=>{var t,a,n,o;let{vibe:c,blockIndex:d,tabIndex:x}=e,{ref:y,intersectionPropertyId:_}=h({id:c.id,blockIndex:d,tabIndex:x}),g=(0,l.x5)({blockId:"wave-".concat(c.id)}),b=(0,r.useMemo)(()=>{var e,t,a,n,r;return c.isLoaded?(0,i.jsx)(p.ti,{titleSize:"xs",titleLineClamp:1,className:f().header,coverUrl:null===(e=c.meta)||void 0===e?void 0:e.imageUrl,title:null!==(r=null===(t=c.meta)||void 0===t?void 0:t.title)&&void 0!==r?r:null===(a=c.meta)||void 0===a?void 0:a.header,titleClassName:f().headerTitle,coverBackgroundColor:null===(n=c.meta)||void 0===n?void 0:n.backgroundColor,coverRadius:"round"}):(0,i.jsx)(p.XM,{className:f().header,coverRadius:"round"})},[c.isLoaded,null===(t=c.meta)||void 0===t?void 0:t.backgroundColor,null===(a=c.meta)||void 0===a?void 0:a.header,null===(n=c.meta)||void 0===n?void 0:n.imageUrl,null===(o=c.meta)||void 0===o?void 0:o.title]),j=(0,r.useMemo)(()=>c.tracks.map((e,t)=>{let a={contextData:{type:v.Ak.Various,meta:{id:c.contextId},overrideAutoflowSeeds:c.autoflowSeeds,overrideContextType:v.Zc.Radio,from:g},queueParams:{index:t},loadContextMeta:!1,entitiesData:c.entitiesData};return(0,i.jsx)(k,{playContextParams:a,type:v.Ak.Vibe,track:e,blockIndex:d,tabIndex:x,trackIndex:t},"".concat(e.id,"_").concat(t))}),[c.tracks,c.contextId,c.autoflowSeeds,c.entitiesData,g,d,x]);return(0,i.jsxs)("section",{className:f().root,ref:y,"data-intersection-property-id":_,children:[(0,i.jsx)(s.Caption,{className:(0,u.W)(f().header,f().heading),type:"text",size:"s",weight:"medium",variant:"div",children:(0,i.jsx)(m.Z,{id:"music-history.my-vibe"})}),b,(0,i.jsx)("div",{className:f().content,children:j})]})});var W=a(17039),L=a.n(W);let N=(0,n.Pi)(e=>{let{tab:t,tabIndex:a,onTabShowOrHide:n,...u}=e,{musicHistory:m}=(0,l.oR)(),v=(0,r.useMemo)(()=>{var e;return null===(e=t.blocks)||void 0===e?void 0:e.map((e,t)=>{switch(e.type){case o.EW.ALBUM:return(0,i.jsx)(j,{album:e,blockIndex:t,tabIndex:a},"".concat(e.key,"_").concat(t));case o.EW.PLAYLIST:return(0,i.jsx)(M,{playlist:e,blockIndex:t,tabIndex:a},"".concat(e.key,"_").concat(t));case o.EW.WAVE:return(0,i.jsx)(E,{vibe:e,blockIndex:t,tabIndex:a},"".concat(e.key,"_").concat(t));case o.EW.ARTIST:return(0,i.jsx)(S,{artist:e,blockIndex:t,tabIndex:a},"".concat(e.key,"_").concat(t));case o.EW.SEARCH:case o.EW.OTHER:return(0,i.jsx)(C,{common:e,blockIndex:t,tabIndex:a},"".concat(e.key,"_").concat(t));default:return null}}).filter(e=>e)},[t.blocks,a]),x=(0,d.useFormatDate)(),p=(0,r.useRef)(null),{observeElement:h}=(0,r.useContext)(c.MusicHistoryIntersectionObserverContext);return(0,r.useEffect)(()=>{h({elementId:t.date,elementRef:p,index:0,onShow:()=>{m.setDatesMap(t.date,!0),n()},onHide:()=>{m.setDatesMap(t.date,!1),n()}})},[m,m.datesMap,h,n,t.date]),(0,i.jsxs)("div",{ref:p,"data-intersection-property-id":t.date,className:L().root,...u,children:[(0,i.jsx)(s.Heading,{"data-date-anchor":t.date,className:L().date,variant:"h2",size:"m",children:x(t.date)}),(0,i.jsx)("div",{className:L().content,children:v})]})})},70579:function(e,t,a){"use strict";a.d(t,{D:function(){return i.SomethingWentWrong}});var i=a(48471)},48471:function(e,t,a){"use strict";a.r(t),a.d(t,{SomethingWentWrong:function(){return p}});var i=a(8759),n=a(35338),r=a(33423),o=a(99616),s=a(2814),l=a(15527),c=a(14581),d=a(1918),u=a(42769),m=a(84133),v=a(29847),x=a.n(v);let p=(0,r.Pi)(e=>{let{className:t,withBackwardControl:a=!0}=e,r=(0,o.useCallback)(()=>{window.location.reload()},[]),{contentRef:v}=(0,m.$Y)();return(0,i.jsxs)("div",{className:(0,n.W)(x().root,t),children:[a&&(0,i.jsx)(u.n,{withBackwardFallback:"/",className:(0,n.W)(x().navigation,{[x().navigation_desktop]:!v}),withForwardControl:!1}),(0,i.jsxs)("div",{className:(0,n.W)(x().content,{[x().content_shrink]:!a}),children:[(0,i.jsx)(c.J,{className:x().icon,variant:"attention",size:"xxl"}),(0,i.jsx)(d.Heading,{className:(0,n.W)(x().title,x().important),variant:"h3",size:"xs",children:(0,i.jsx)(s.Z,{id:"error-messages.something-went-wrong"})}),(0,i.jsxs)(d.Caption,{className:(0,n.W)(x().text,x().important),variant:"span",type:"text",size:"l",weight:"normal",children:[!1,(0,i.jsx)(s.Z,{id:"page-error.try-to-restart-app"})]}),(0,i.jsx)(l.z,{onClick:r,className:x().button,role:"link",color:"secondary",size:"l",radius:"xxxl",children:(0,i.jsxs)(d.Caption,{type:"controls",variant:"span",size:"m",children:[!1,(0,i.jsx)(s.Z,{id:"page-error.restart-app-button"})]})})]})]})})},36518:function(e){e.exports={root:"MusicHistoryPage_root__FYB2m",scroll:"MusicHistoryPage_scroll__ykpDX",scrollContainer:"MusicHistoryPage_scrollContainer__eemvg",headerContainer:"MusicHistoryPage_headerContainer__QG0L3",header:"MusicHistoryPage_header__dzEvD",content:"MusicHistoryPage_content__j4evw",footer:"MusicHistoryPage_footer__Vu7aC",empty:"MusicHistoryPage_empty__fQRHA",tabs:"MusicHistoryPage_tabs__v_5Zg",tab:"MusicHistoryPage_tab__WDE1e",tab_isLoading:"MusicHistoryPage_tab_isLoading__nNqd2",tab_selected:"MusicHistoryPage_tab_selected__nmn8P",date:"MusicHistoryPage_date__OV6rR",error:"MusicHistoryPage_error__9f_8i",important:"MusicHistoryPage_important__qNFO8"}},76098:function(e){e.exports={shimmersContainer:"MusicHistoryPageContentShimmer_shimmersContainer__82cj6",dateShimmer:"MusicHistoryPageContentShimmer_dateShimmer__d4_te",contextNameShimmer:"MusicHistoryPageContentShimmer_contextNameShimmer__Tzbqr",contextHeaderShimmer:"MusicHistoryPageContentShimmer_contextHeaderShimmer__Tq0PZ",trackListShimmers:"MusicHistoryPageContentShimmer_trackListShimmers__4GSp8"}},17039:function(e){e.exports={date:"MusicHistoryTab_date__Fjy3P",content:"MusicHistoryTab_content__Jt15j"}},66710:function(e){e.exports={trackShimmer:"MusicHistoryTrack_trackShimmer__yxcx9"}},65019:function(e){e.exports={header:"MusicHistoryBlock_header__sIFVC",heading:"MusicHistoryBlock_heading__HEfmk",headerTitle:"MusicHistoryBlock_headerTitle__Yhyst",content:"MusicHistoryBlock_content__S9lfi",artists:"MusicHistoryBlock_artists__AjuWP",artistLink:"MusicHistoryBlock_artistLink__yFHPE",shimmerTitle:"MusicHistoryBlock_shimmerTitle__Mx1IC"}},29847:function(e){e.exports={root:"SomethingWentWrong_root__d77VJ",content:"SomethingWentWrong_content__8_YkJ",content_shrink:"SomethingWentWrong_content_shrink__GOR_7",navigation:"SomethingWentWrong_navigation__a8eMG",navigation_desktop:"SomethingWentWrong_navigation_desktop__WGGBX",icon:"SomethingWentWrong_icon__f15_y",title:"SomethingWentWrong_title__Kn89B",important:"SomethingWentWrong_important__namIb",text:"SomethingWentWrong_text__KEfGc",button:"SomethingWentWrong_button__dmh7t"}}}]);